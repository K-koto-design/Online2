<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ö-–ë–∞–Ω–∫</title>
    <meta name="apple-mobile-web-app-title" content="–ö-–ë–∞–Ω–∫">
    <link rel="apple-touch-icon" href="https://i.postimg.cc/QtVHC5G0/IMG-3035.jpg">
    <link rel="icon" type="image/png" href="https://i.postimg.cc/QtVHC5G0/IMG-3035.jpg">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script src="https://unpkg.com/html5-qrcode"></script>

    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.12);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
            --apple-bg: linear-gradient(135deg, #0a0c17 0%, #1a1b2e 100%);
            --neon-blue: #007AFF;
            --neon-green: #30D158;
            --neon-orange: #FF9500;
            --neon-red: #FF3B30;
            --neon-purple: #AF52DE;
            --text-main: rgba(255, 255, 255, 0.95);
            --text-dim: rgba(255, 255, 255, 0.6);
            --radius-xl: 28px;
            --radius-lg: 20px;
            --radius-md: 16px;
            --radius-sm: 12px;
            --anim-smooth: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
        }

        body, html {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: var(--apple-bg);
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', sans-serif;
            color: var(--text-main);
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(40px) saturate(200%);
            -webkit-backdrop-filter: blur(40px) saturate(200%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-xl);
            box-shadow: 
                0 4px 6px rgba(0, 0, 0, 0.1),
                0 1px 3px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .glass-effect::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 50%, 
                transparent 100%);
            pointer-events: none;
        }

        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .animated-bg::before,
        .animated-bg::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            animation: float 15s infinite linear;
        }

        .animated-bg::before {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(0, 122, 255, 0.15) 0%, transparent 70%);
            top: -200px;
            right: -100px;
            animation-delay: 0s;
        }

        .animated-bg::after {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(175, 82, 222, 0.1) 0%, transparent 70%);
            bottom: -150px;
            left: -100px;
            animation-delay: -7.5s;
            animation-direction: reverse;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(20px, 20px) rotate(90deg); }
            50% { transform: translate(0, 40px) rotate(180deg); }
            75% { transform: translate(-20px, 20px) rotate(270deg); }
        }

        #snow-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9998;
        }

        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            z-index: 10;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity var(--anim-smooth), transform var(--anim-smooth);
            display: none;
        }

        .screen.active {
            opacity: 1;
            transform: translateY(0);
            display: flex;
            flex-direction: column;
        }

        .nav-bar {
            height: 88px;
            padding: 0 20px;
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(10, 12, 23, 0.8);
            backdrop-filter: blur(20px);
        }

        .nav-title {
            font-size: 34px;
            font-weight: 800;
            letter-spacing: -0.5px;
            margin-bottom: 12px;
        }

        .nav-button {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-main);
            font-size: 20px;
            cursor: pointer;
            transition: all var(--anim-smooth);
            margin-bottom: 12px;
        }

        .nav-button:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.15);
        }

        .content {
            flex: 1;
            padding: 20px;
            padding-bottom: 100px;
            overflow-y: auto;
        }

        .balance-cards {
            margin-bottom: 30px;
        }

        .balance-card {
            margin-bottom: 16px;
            padding: 24px;
            cursor: pointer;
            transition: all var(--anim-smooth);
            position: relative;
        }

        .balance-card:active {
            transform: scale(0.99);
        }

        .balance-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-name {
            font-size: 17px;
            font-weight: 600;
            color: var(--text-dim);
        }

        .card-number {
            font-size: 15px;
            color: var(--text-dim);
            letter-spacing: 1px;
        }

        .balance-amount {
            font-size: 40px;
            font-weight: 800;
            letter-spacing: -1px;
            margin-bottom: 8px;
        }

        .balance-change {
            font-size: 15px;
            color: var(--neon-green);
            font-weight: 600;
        }

        .balance-change.negative {
            color: var(--neon-red);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 30px;
        }

        .action-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 16px 8px;
            border-radius: var(--radius-lg);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.08);
            cursor: pointer;
            transition: all var(--anim-smooth);
        }

        .action-button:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.1);
        }

        .action-icon {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            background: rgba(0, 122, 255, 0.1);
            color: var(--neon-blue);
        }

        .action-icon.red { background: rgba(255, 59, 48, 0.1); color: var(--neon-red); }
        .action-icon.green { background: rgba(48, 209, 88, 0.1); color: var(--neon-green); }
        .action-icon.orange { background: rgba(255, 149, 0, 0.1); color: var(--neon-orange); }
        .action-icon.purple { background: rgba(175, 82, 222, 0.1); color: var(--neon-purple); }

        .action-text {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-dim);
            text-align: center;
        }

        .transactions-section {
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.3px;
        }

        .see-all {
            font-size: 15px;
            color: var(--neon-blue);
            font-weight: 600;
            cursor: pointer;
        }

        .transactions-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .transaction-item {
            padding: 16px;
            border-radius: var(--radius-lg);
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 16px;
            cursor: pointer;
            transition: all var(--anim-smooth);
        }

        .transaction-item:active {
            transform: scale(0.99);
            background: rgba(255, 255, 255, 0.05);
        }

        .transaction-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            background: rgba(255, 255, 255, 0.08);
        }

        .transaction-info {
            flex: 1;
        }

        .transaction-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .transaction-description {
            font-size: 14px;
            color: var(--text-dim);
        }

        .transaction-amount {
            font-size: 17px;
            font-weight: 700;
            text-align: right;
        }

        .amount-positive {
            color: var(--neon-green);
        }

        .amount-negative {
            color: var(--text-main);
        }

        .amount-pending {
            color: var(--neon-orange);
        }

        .tab-bar {
            height: 83px;
            padding: 0 20px;
            display: flex;
            align-items: flex-start;
            justify-content: space-around;
            background: rgba(10, 12, 23, 0.9);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 100;
        }

        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 12px 16px;
            cursor: pointer;
            transition: all var(--anim-smooth);
        }

        .tab-item.active .tab-icon {
            color: var(--neon-blue);
            transform: scale(1.1);
        }

        .tab-icon {
            font-size: 24px;
            color: var(--text-dim);
            transition: all var(--anim-smooth);
        }

        .tab-label {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-dim);
        }

        .tab-item.active .tab-label {
            color: var(--neon-blue);
        }

        .auth-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px 24px;
            background: rgba(10, 12, 23, 0.95);
        }

        .logo {
            font-size: 64px;
            font-weight: 900;
            background: linear-gradient(135deg, #fff 0%, var(--neon-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -2px;
            margin-bottom: 16px;
        }

        .logo-subtitle {
            font-size: 18px;
            color: var(--text-dim);
            margin-bottom: 50px;
            text-align: center;
        }

        .auth-input {
            width: 100%;
            height: 56px;
            padding: 0 20px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            font-size: 17px;
            color: var(--text-main);
            margin-bottom: 16px;
            transition: all var(--anim-smooth);
        }

        .auth-input:focus {
            outline: none;
            border-color: var(--neon-blue);
            background: rgba(255, 255, 255, 0.1);
        }

        .auth-button {
            width: 100%;
            height: 56px;
            border: none;
            border-radius: var(--radius-lg);
            background: var(--neon-blue);
            color: white;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--anim-smooth);
        }

        .auth-button:active {
            transform: scale(0.98);
            opacity: 0.9;
        }

        .pin-container {
            padding: 100px 24px 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background: rgba(10, 12, 23, 0.95);
        }

        .pin-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            text-align: center;
        }

        .pin-subtitle {
            font-size: 16px;
            color: var(--text-dim);
            margin-bottom: 40px;
            text-align: center;
        }

        .pin-dots {
            display: flex;
            gap: 24px;
            margin: 40px 0;
        }

        .pin-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all var(--anim-smooth);
        }

        .pin-dot.active {
            background: var(--neon-blue);
            border-color: var(--neon-blue);
            box-shadow: 0 0 20px rgba(0, 122, 255, 0.5);
            transform: scale(1.2);
        }

        .numeric-keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            width: 100%;
            max-width: 320px;
            margin-top: 40px;
        }

        .keypad-button {
            height: 70px;
            border-radius: var(--radius-lg);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: 400;
            color: var(--text-main);
            cursor: pointer;
            transition: all var(--anim-smooth);
            user-select: none;
        }

        .keypad-button:active {
            background: rgba(255, 255, 255, 0.15);
            transform: scale(0.95);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .keypad-button.delete {
            font-size: 24px;
            color: var(--neon-red);
        }

        .keypad-button.empty {
            opacity: 0;
            pointer-events: none;
        }

        .qr-scanner {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            display: none;
            backdrop-filter: blur(20px);
        }

        .qr-frame {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 280px;
            height: 280px;
            border: 2px solid var(--neon-blue);
            border-radius: var(--radius-xl);
            box-shadow: 0 0 40px rgba(0, 122, 255, 0.3);
        }

        .qr-laser {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--neon-blue);
            animation: scan 2s ease-in-out infinite;
            box-shadow: 0 0 10px var(--neon-blue);
        }

        @keyframes scan {
            0%, 100% { top: 0; }
            50% { top: 100%; }
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10001;
            display: none;
            backdrop-filter: blur(20px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 380px;
            padding: 32px;
            border-radius: var(--radius-xl);
            background: rgba(40, 40, 60, 0.95);
            backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: modalAppear 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .modal-icon {
            font-size: 60px;
            margin-bottom: 20px;
            display: block;
            text-align: center;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 16px;
            text-align: center;
        }

        .modal-amount {
            font-size: 48px;
            font-weight: 800;
            margin: 24px 0;
            text-align: center;
            background: linear-gradient(135deg, var(--neon-blue) 0%, #5AC8FA 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .modal-button {
            flex: 1;
            height: 56px;
            border-radius: var(--radius-lg);
            border: none;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--anim-smooth);
        }

        .modal-button.primary {
            background: var(--neon-blue);
            color: white;
        }

        .modal-button.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .modal-button:active {
            transform: scale(0.98);
        }

        .settings-container {
            padding: 20px;
            padding-bottom: 100px;
        }

        .settings-section {
            margin-bottom: 30px;
        }

        .settings-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 20px;
            letter-spacing: -0.3px;
        }

        .settings-item {
            padding: 18px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-lg);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all var(--anim-smooth);
        }

        .settings-item:active {
            transform: scale(0.99);
            background: rgba(255, 255, 255, 0.05);
        }

        .settings-item-content {
            display: flex;
            align-items: center;
            gap: 16px;
            flex: 1;
        }

        .settings-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            background: rgba(255, 255, 255, 0.08);
        }

        .settings-text {
            flex: 1;
        }

        .settings-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .settings-description {
            font-size: 14px;
            color: var(--text-dim);
        }

        .settings-arrow {
            font-size: 20px;
            color: var(--text-dim);
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 32px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.1);
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--neon-blue);
        }

        input:checked + .slider:before {
            transform: translateX(20px);
        }

        .card-history-screen {
            background: rgba(10, 12, 23, 0.95);
        }

        .history-header {
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .history-card {
            padding: 20px;
            margin: 20px;
            border-radius: var(--radius-xl);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-list {
            padding: 0 20px 100px;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--neon-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .select-input {
            width: 100%;
            height: 56px;
            padding: 0 20px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            font-size: 17px;
            color: var(--text-main);
            margin-bottom: 16px;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 20px center;
            background-size: 20px;
        }

        .textarea-input {
            width: 100%;
            min-height: 100px;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            font-size: 17px;
            color: var(--text-main);
            margin-bottom: 16px;
            resize: vertical;
            font-family: inherit;
        }

        .textarea-input:focus {
            outline: none;
            border-color: var(--neon-blue);
            background: rgba(255, 255, 255, 0.1);
        }

        .update-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--neon-red);
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 20px;
            text-align: center;
        }

        .update-item {
            margin-bottom: 16px;
        }

        .update-date {
            font-size: 14px;
            color: var(--text-dim);
            margin-bottom: 4px;
        }

        .update-description {
            font-size: 15px;
            line-height: 1.4;
        }

        .maintenance-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 99999;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(50px) saturate(200%);
            -webkit-backdrop-filter: blur(50px) saturate(200%);
            background: rgba(0, 0, 0, 0.7);
        }

        .maintenance-container {
            width: 90%;
            max-width: 400px;
            padding: 40px 32px;
            border-radius: 28px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(40px) saturate(200%);
            -webkit-backdrop-filter: blur(40px) saturate(200%);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            text-align: center;
            animation: modalAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .maintenance-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 50%, 
                transparent 100%);
            pointer-events: none;
        }

        .maintenance-icon {
            font-size: 64px;
            margin-bottom: 24px;
            display: block;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .maintenance-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 16px;
            letter-spacing: -0.5px;
        }

        .maintenance-message {
            font-size: 18px;
            color: var(--text-dim);
            line-height: 1.5;
            margin-bottom: 32px;
        }

        .maintenance-progress {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 24px;
        }

        .maintenance-progress-bar {
            height: 100%;
            width: 60%;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            border-radius: 3px;
            animation: progressAnimation 3s ease-in-out infinite;
        }

        @keyframes progressAnimation {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(400%); }
        }

        .maintenance-time {
            font-size: 15px;
            color: var(--text-dim);
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .maintenance-details {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.4);
            margin-top: 8px;
        }

        .glass-logo {
            position: relative;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(40px) saturate(200%);
            -webkit-backdrop-filter: blur(40px) saturate(200%);
            border-radius: 28px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                0 0 0 1px rgba(255, 255, 255, 0.05);
            margin-bottom: 16px;
            overflow: hidden;
        }

        .glass-logo::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 50%, 
                transparent 100%);
            pointer-events: none;
        }

        .glass-logo::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent 30%,
                rgba(255, 255, 255, 0.03) 50%,
                transparent 70%
            );
            animation: shine 3s infinite linear;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .logo-text {
            font-size: 48px;
            font-weight: 900;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.95) 0%, 
                rgba(255, 255, 255, 0.7) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.2),
                0 0 20px rgba(0, 122, 255, 0.3);
            z-index: 1;
            letter-spacing: -2px;
        }

        .logo-glow {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 28px;
            box-shadow: 
                inset 0 0 40px rgba(0, 122, 255, 0.1),
                0 0 60px rgba(0, 122, 255, 0.2);
            pointer-events: none;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: inset 0 0 40px rgba(0, 122, 255, 0.1), 0 0 60px rgba(0, 122, 255, 0.2); }
            to { box-shadow: inset 0 0 60px rgba(0, 122, 255, 0.15), 0 0 80px rgba(0, 122, 255, 0.3); }
        }
    </style>
</head>
<body>
    <div class="maintenance-overlay" id="maintenance-overlay">
        <div class="maintenance-container">
            <div class="maintenance-icon">üîß</div>
            <h1 class="maintenance-title">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h1>
            <p class="maintenance-message" id="maintenance-message">
                –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, –∑–∞–π–¥–∏—Ç–µ –ø–æ–∑–∂–µ
            </p>
            <div class="maintenance-progress">
                <div class="maintenance-progress-bar"></div>
            </div>
            <div class="maintenance-time">
                –†–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ —É–ª—É—á—à–µ–Ω–∏–µ–º —Å–µ—Ä–≤–∏—Å–∞
                <div class="maintenance-details">
                    –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã ‚Ä¢ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã ‚Ä¢ –ü–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                </div>
            </div>
        </div>
    </div>

    <div class="animated-bg"></div>

    <canvas id="snow-canvas"></canvas>

    <div class="qr-scanner" id="qr-screen">
        <div id="reader"></div>
        <div class="qr-frame">
            <div class="qr-laser"></div>
        </div>
        <button class="modal-button secondary" onclick="bank.closeScanner()" style="position: fixed; bottom: 60px; left: 50%; transform: translateX(-50%); width: 200px;">–û–¢–ú–ï–ù–ê</button>
    </div>

    <div class="modal-overlay" id="modal-qr-pay">
        <div class="modal-content">
            <div class="modal-icon">üí≥</div>
            <h2 class="modal-title">–û–ø–ª–∞—Ç–∞ –ø–æ QR-–∫–æ–¥—É</h2>
            <div class="modal-amount" id="qr-pay-sum">0 ‚ÇΩ</div>
            <div class="modal-buttons">
                <button class="modal-button secondary" onclick="document.getElementById('modal-qr-pay').style.display='none'">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-button primary" id="confirm-qr-btn">–û–ø–ª–∞—Ç–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="modal-success">
        <div class="modal-content">
            <div class="modal-icon" id="success-icon">‚úÖ</div>
            <h2 class="modal-title" id="suc-h">–£—Å–ø–µ—à–Ω–æ!</h2>
            <div class="modal-amount" id="suc-val">0 ‚ÇΩ</div>
            <p style="text-align: center; color: var(--text-dim); margin-bottom: 30px;" id="suc-p"></p>
            <button class="modal-button primary" onclick="view.hideSuccess()">–ì–æ—Ç–æ–≤–æ</button>
        </div>
    </div>

    <div class="modal-overlay" id="modal-confirm">
        <div class="modal-content">
            <div class="modal-icon" id="confirm-icon">‚ö†Ô∏è</div>
            <h2 class="modal-title" id="confirm-title">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ</h2>
            <p style="text-align: center; color: var(--text-dim); margin-bottom: 30px;" id="confirm-text"></p>
            <div class="modal-buttons">
                <button class="modal-button secondary" onclick="document.getElementById('modal-confirm').style.display='none'">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-button primary" id="confirm-action-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="screen-auth" class="screen active">
        <div class="auth-container">
            <div class="glass-logo">
                <div class="logo-text">K</div>
                <div class="logo-glow"></div>
            </div>
            <h1 class="logo">–ö-–ë–∞–Ω–∫</h1>
            <p class="logo-subtitle">–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —É—Å–ª—É–≥–∏ –≤ —Å—Ç–∏–ª–µ Apple</p>
            <input type="number" class="auth-input" id="auth-tg-id" placeholder="–í–∞—à Telegram ID">
            <button class="auth-button" onclick="logic.requestOTP()">–í–æ–π—Ç–∏</button>
            <p style="margin-top: 40px; color: var(--text-dim); font-size: 15px;">
                –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? 
                <span style="color: var(--neon-blue); cursor: pointer; font-weight: 600;" onclick="view.nav('screen-register')">
                    –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                </span>
            </p>
        </div>
    </div>

    <div id="screen-register" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-auth')">‚Üê</div>
            <div class="nav-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <input type="number" class="auth-input" id="reg-tg-id" placeholder="Telegram ID">
            <input type="text" class="auth-input" id="reg-name" placeholder="–í–∞—à–µ –∏–º—è">
            <input type="password" class="auth-input" id="reg-pin" placeholder="–ü–ò–ù-–∫–æ–¥ (4 —Ü–∏—Ñ—Ä—ã)" maxlength="4" inputmode="numeric">
            <button class="auth-button" onclick="logic.registerRequest()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
        </div>
    </div>

    <div id="screen-otp-entry" class="screen">
        <div class="pin-container">
            <h2 class="pin-title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h2>
            <p class="pin-subtitle">–í–≤–µ–¥–∏—Ç–µ 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –∏–∑ Telegram</p>
            <div class="pin-dots">
                <div class="pin-dot" id="otp-0"></div>
                <div class="pin-dot" id="otp-1"></div>
                <div class="pin-dot" id="otp-2"></div>
                <div class="pin-dot" id="otp-3"></div>
                <div class="pin-dot" id="otp-4"></div>
                <div class="pin-dot" id="otp-5"></div>
            </div>
            
            <div class="numeric-keypad">
                <div class="keypad-button" onclick="logic.tapOtp('1')">1</div>
                <div class="keypad-button" onclick="logic.tapOtp('2')">2</div>
                <div class="keypad-button" onclick="logic.tapOtp('3')">3</div>
                <div class="keypad-button" onclick="logic.tapOtp('4')">4</div>
                <div class="keypad-button" onclick="logic.tapOtp('5')">5</div>
                <div class="keypad-button" onclick="logic.tapOtp('6')">6</div>
                <div class="keypad-button" onclick="logic.tapOtp('7')">7</div>
                <div class="keypad-button" onclick="logic.tapOtp('8')">8</div>
                <div class="keypad-button" onclick="logic.tapOtp('9')">9</div>
                <div class="keypad-button empty"></div>
                <div class="keypad-button" onclick="logic.tapOtp('0')">0</div>
                <div class="keypad-button delete" onclick="logic.tapOtp('DEL')">‚å´</div>
            </div>
        </div>
    </div>

    <div id="screen-pin-entry" class="screen">
        <div class="pin-container">
            <h2 class="pin-title">–í–≤–µ–¥–∏—Ç–µ –ü–ò–ù-–∫–æ–¥</h2>
            <p class="pin-subtitle" id="pin-user-name">–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–∫–∫–∞—É–Ω—Ç—É</p>
            <div class="pin-dots">
                <div class="pin-dot" id="pin-0"></div>
                <div class="pin-dot" id="pin-1"></div>
                <div class="pin-dot" id="pin-2"></div>
                <div class="pin-dot" id="pin-3"></div>
            </div>
            
            <div class="numeric-keypad">
                <div class="keypad-button" onclick="logic.tapPin('1')">1</div>
                <div class="keypad-button" onclick="logic.tapPin('2')">2</div>
                <div class="keypad-button" onclick="logic.tapPin('3')">3</div>
                <div class="keypad-button" onclick="logic.tapPin('4')">4</div>
                <div class="keypad-button" onclick="logic.tapPin('5')">5</div>
                <div class="keypad-button" onclick="logic.tapPin('6')">6</div>
                <div class="keypad-button" onclick="logic.tapPin('7')">7</div>
                <div class="keypad-button" onclick="logic.tapPin('8')">8</div>
                <div class="keypad-button" onclick="logic.tapPin('9')">9</div>
                <div class="keypad-button empty"></div>
                <div class="keypad-button" onclick="logic.tapPin('0')">0</div>
                <div class="keypad-button delete" onclick="logic.tapPin('DEL')">‚å´</div>
            </div>
        </div>
    </div>

    <div id="screen-home" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="bank.openScanner()">üì∑</div>
            <div class="nav-title">–ì–ª–∞–≤–Ω–∞—è</div>
            <div class="nav-button" onclick="view.nav('screen-profile')">üë§</div>
        </div>
        
        <div class="content">
            <div class="balance-cards" id="balance-cards"></div>

            <div class="quick-actions">
                <div class="action-button" onclick="view.nav('screen-transfer')">
                    <div class="action-icon">üí∏</div>
                    <div class="action-text">–ü–µ—Ä–µ–≤–æ–¥</div>
                </div>
                <div class="action-button" onclick="view.nav('screen-exchange')">
                    <div class="action-icon green">üíµ</div>
                    <div class="action-text">–û–±–º–µ–Ω</div>
                </div>
                <div class="action-button" onclick="bank.loan()">
                    <div class="action-icon orange">üìà</div>
                    <div class="action-text">–ö—Ä–µ–¥–∏—Ç</div>
                </div>
                <div class="action-button" onclick="view.nav('screen-history')">
                    <div class="action-icon purple">üìä</div>
                    <div class="action-text">–ò—Å—Ç–æ—Ä–∏—è</div>
                </div>
            </div>

            <div class="transactions-section">
                <div class="section-header">
                    <div class="section-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</div>
                    <div class="see-all" onclick="view.nav('screen-history')">–í—Å–µ</div>
                </div>
                <div class="transactions-list" id="recent-transactions"></div>
            </div>
        </div>

        <div class="tab-bar">
            <div class="tab-item active" onclick="view.nav('screen-home')">
                <div class="tab-icon">üè†</div>
                <div class="tab-label">–ì–ª–∞–≤–Ω–∞—è</div>
            </div>
            <div class="tab-item" onclick="view.nav('screen-history')">
                <div class="tab-icon">üìä</div>
                <div class="tab-label">–ò—Å—Ç–æ—Ä–∏—è</div>
            </div>
            <div class="tab-item" onclick="view.nav('screen-settings')">
                <div class="tab-icon">‚öôÔ∏è</div>
                <div class="tab-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            </div>
        </div>
    </div>

    <div id="screen-history" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-home')">‚Üê</div>
            <div class="nav-title">–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="transactions-list" id="full-history-list"></div>
        </div>
    </div>

    <div id="screen-card-history" class="screen card-history-screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-home')">‚Üê</div>
            <div class="nav-title" id="card-history-title">–ò—Å—Ç–æ—Ä–∏—è –∫–∞—Ä—Ç—ã</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="history-header">
            <div class="glass-effect" id="selected-card-display" style="padding: 20px;"></div>
        </div>
        <div class="history-list" id="card-history-list"></div>
    </div>

    <div id="screen-transfer" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-home')">‚Üê</div>
            <div class="nav-title">–ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <input type="text" class="auth-input" id="tr-target" placeholder="ID –ø–æ–ª—É—á–∞—Ç–µ–ª—è –∏–ª–∏ –∏–º—è">
            <input type="number" class="auth-input" id="tr-val" placeholder="–°—É–º–º–∞ –≤ —Ä—É–±–ª—è—Ö" inputmode="numeric">
            <textarea class="textarea-input" id="tr-msg" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –ø–µ—Ä–µ–≤–æ–¥—É (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
            <button class="auth-button" onclick="bank.send()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥</button>
        </div>
    </div>

    <div id="screen-exchange" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-home')">‚Üê</div>
            <div class="nav-title">–û–±–º–µ–Ω –≤–∞–ª—é—Ç—ã</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="glass-effect" style="padding: 24px; margin-bottom: 20px; text-align: center;">
                <div style="font-size: 14px; color: var(--text-dim); margin-bottom: 8px;">–ö—É—Ä—Å USD/RUB</div>
                <div style="font-size: 32px; font-weight: 800; margin-bottom: 20px;">91.20 ‚ÇΩ</div>
                <input type="number" class="auth-input" id="ex-val" placeholder="–°—É–º–º–∞ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö" inputmode="decimal">
            </div>
            <button class="auth-button" onclick="bank.exchange()">–û–±–º–µ–Ω—è—Ç—å –≤–∞–ª—é—Ç—É</button>
        </div>
    </div>

    <div id="screen-profile" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-home')">‚Üê</div>
            <div class="nav-title">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="glass-effect" style="padding: 24px; margin-bottom: 20px; text-align: center;">
                <div style="width: 80px; height: 80px; border-radius: 40px; background: linear-gradient(135deg, var(--neon-blue) 0%, #5AC8FA 100%); margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; font-size: 32px; font-weight: 800;" id="profile-avatar">?</div>
                <div style="font-size: 22px; font-weight: 700; margin-bottom: 4px;" id="profile-name">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                <div style="font-size: 15px; color: var(--text-dim);" id="profile-tg-id">ID: ---</div>
            </div>
            
            <div class="glass-effect" style="padding: 20px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                    <span style="color: var(--text-dim);">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å:</span>
                    <span style="font-weight: 700;" id="profile-total-balance">0 ‚ÇΩ</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                    <span style="color: var(--text-dim);">–í –¥–æ–ª–ª–∞—Ä–∞—Ö:</span>
                    <span style="font-weight: 700;" id="profile-usd">0 $</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span style="color: var(--text-dim);">–ö—Ä–µ–¥–∏—Ç–Ω—ã–π –ª–∏–º–∏—Ç:</span>
                    <span style="font-weight: 700; color: var(--neon-orange);" id="profile-credit">0 ‚ÇΩ</span>
                </div>
            </div>
            
            <button class="auth-button" style="background: var(--neon-red); margin-top: 40px;" onclick="logic.logout()">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</button>
        </div>
    </div>

    <div id="screen-settings" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-home')">‚Üê</div>
            <div class="nav-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="settings-section">
                <div class="settings-title">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</div>
                
                <div class="settings-item" onclick="view.nav('screen-change-pin')">
                    <div class="settings-item-content">
                        <div class="settings-icon">üîí</div>
                        <div class="settings-text">
                            <div class="settings-name">–°–º–µ–Ω–∏—Ç—å –ü–ò–ù-–∫–æ–¥</div>
                            <div class="settings-description">–ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é</div>
                        </div>
                    </div>
                    <div class="settings-arrow">‚Üí</div>
                </div>
                
                <div class="settings-item" onclick="settings.toggleBiometric()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üëÅÔ∏è</div>
                        <div class="settings-text">
                            <div class="settings-name">–ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</div>
                            <div class="settings-description">–í—Ö–æ–¥ –ø–æ –æ—Ç–ø–µ—á–∞—Ç–∫—É –∏–ª–∏ Face ID</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="biometric-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-item" onclick="settings.toggleNotifications()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üîî</div>
                        <div class="settings-text">
                            <div class="settings-name">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                            <div class="settings-description">–ü–æ–ª—É—á–∞—Ç—å –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –æ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="notifications-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="settings-section">
                <div class="settings-title">–í–Ω–µ—à–Ω–∏–π –≤–∏–¥</div>
                
                <div class="settings-item" onclick="settings.toggleDarkMode()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üåô</div>
                        <div class="settings-text">
                            <div class="settings-name">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</div>
                            <div class="settings-description">–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–º–Ω—ã–π —Ä–µ–∂–∏–º</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="dark-mode-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-item" onclick="view.nav('screen-currency')">
                    <div class="settings-item-content">
                        <div class="settings-icon">üí±</div>
                        <div class="settings-text">
                            <div class="settings-name">–û—Å–Ω–æ–≤–Ω–∞—è –≤–∞–ª—é—Ç–∞</div>
                            <div class="settings-description" id="currency-display">–†–æ—Å—Å–∏–π—Å–∫–∏–π —Ä—É–±–ª—å (RUB)</div>
                        </div>
                    </div>
                    <div class="settings-arrow">‚Üí</div>
                </div>
                
                <div class="settings-item" onclick="settings.toggleSnow()">
                    <div class="settings-item-content">
                        <div class="settings-icon">‚ùÑÔ∏è</div>
                        <div class="settings-text">
                            <div class="settings-name">–°–Ω–µ–∂–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è</div>
                            <div class="settings-description">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–Ω–µ–∂–∏–Ω–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="snow-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="settings-section">
                <div class="settings-title">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                
                <div class="settings-item" onclick="settings.togglePushNotifications()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üì±</div>
                        <div class="settings-text">
                            <div class="settings-name">Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                            <div class="settings-description">–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="push-notifications-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-item" onclick="settings.toggleSound()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üîä</div>
                        <div class="settings-text">
                            <div class="settings-name">–ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                            <div class="settings-description">–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –∑–≤—É–∫ –ø—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="sound-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-item" onclick="settings.toggleVibration()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üì≥</div>
                        <div class="settings-text">
                            <div class="settings-name">–í–∏–±—Ä–∞—Ü–∏—è</div>
                            <div class="settings-description">–í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="vibration-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="settings-section">
                <div class="settings-title">–û–±–Ω–æ–≤–ª–µ–Ω–∏—è</div>
                
                <div class="settings-item" onclick="view.nav('screen-updates')">
                    <div class="settings-item-content">
                        <div class="settings-icon">üîÑ</div>
                        <div class="settings-text">
                            <div class="settings-name">–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div>
                            <div class="settings-description" id="updates-status">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</div>
                        </div>
                    </div>
                    <div class="settings-arrow">‚Üí</div>
                    <div id="update-badge" class="update-badge" style="display: none;">1</div>
                </div>
                
                <div class="settings-item" onclick="settings.toggleAutoUpdate()">
                    <div class="settings-item-content">
                        <div class="settings-icon">‚ö°</div>
                        <div class="settings-text">
                            <div class="settings-name">–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</div>
                            <div class="settings-description">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="auto-update-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="settings-section">
                <div class="settings-title">–ê–∫–∫–∞—É–Ω—Ç</div>
                
                <div class="settings-item" onclick="view.nav('screen-privacy')">
                    <div class="settings-item-content">
                        <div class="settings-icon">üõ°Ô∏è</div>
                        <div class="settings-text">
                            <div class="settings-name">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</div>
                            <div class="settings-description">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏</div>
                        </div>
                    </div>
                    <div class="settings-arrow">‚Üí</div>
                </div>
                
                <div class="settings-item" onclick="view.nav('screen-support')">
                    <div class="settings-item-content">
                        <div class="settings-icon">üí¨</div>
                        <div class="settings-text">
                            <div class="settings-name">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                            <div class="settings-description">–°–≤—è–∑–∞—Ç—å—Å—è —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</div>
                        </div>
                    </div>
                    <div class="settings-arrow">‚Üí</div>
                </div>
                
                <div class="settings-item" onclick="view.nav('screen-about')">
                    <div class="settings-item-content">
                        <div class="settings-icon">‚ÑπÔ∏è</div>
                        <div class="settings-text">
                            <div class="settings-name">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</div>
                            <div class="settings-description">–í–µ—Ä—Å–∏—è –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–µ</div>
                        </div>
                    </div>
                    <div class="settings-arrow">‚Üí</div>
                </div>
            </div>
            
            <div class="settings-section">
                <div class="settings-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</div>
                
                <div class="settings-item" onclick="settings.clearCache()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üßπ</div>
                        <div class="settings-text">
                            <div class="settings-name">–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à</div>
                            <div class="settings-description">–£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</div>
                        </div>
                    </div>
                    <div class="settings-arrow">‚Üí</div>
                </div>
                
                <div class="settings-item" onclick="settings.exportData()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üì§</div>
                        <div class="settings-text">
                            <div class="settings-name">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</div>
                            <div class="settings-description">–°–∫–∞—á–∞—Ç—å –≤—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</div>
                        </div>
                    </div>
                    <div class="settings-arrow">‚Üí</div>
                </div>
                
                <div class="settings-item" onclick="settings.resetSettings()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üîÑ</div>
                        <div class="settings-text">
                            <div class="settings-name">–°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                            <div class="settings-description">–í–µ—Ä–Ω—É—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</div>
                        </div>
                    </div>
                    <div class="settings-arrow">‚Üí</div>
                </div>
            </div>
        </div>
    </div>

    <div id="screen-change-pin" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-settings')">‚Üê</div>
            <div class="nav-title">–°–º–µ–Ω–∞ –ü–ò–ù-–∫–æ–¥–∞</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="pin-container" style="padding: 40px 24px;">
                <h2 class="pin-title">–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ü–ò–ù-–∫–æ–¥</h2>
                <p class="pin-subtitle">–î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</p>
                <div class="pin-dots">
                    <div class="pin-dot" id="current-pin-0"></div>
                    <div class="pin-dot" id="current-pin-1"></div>
                    <div class="pin-dot" id="current-pin-2"></div>
                    <div class="pin-dot" id="current-pin-3"></div>
                </div>
                
                <div class="numeric-keypad">
                    <div class="keypad-button" onclick="settings.tapCurrentPin('1')">1</div>
                    <div class="keypad-button" onclick="settings.tapCurrentPin('2')">2</div>
                    <div class="keypad-button" onclick="settings.tapCurrentPin('3')">3</div>
                    <div class="keypad-button" onclick="settings.tapCurrentPin('4')">4</div>
                    <div class="keypad-button" onclick="settings.tapCurrentPin('5')">5</div>
                    <div class="keypad-button" onclick="settings.tapCurrentPin('6')">6</div>
                    <div class="keypad-button" onclick="settings.tapCurrentPin('7')">7</div>
                    <div class="keypad-button" onclick="settings.tapCurrentPin('8')">8</div>
                    <div class="keypad-button" onclick="settings.tapCurrentPin('9')">9</div>
                    <div class="keypad-button empty"></div>
                    <div class="keypad-button" onclick="settings.tapCurrentPin('0')">0</div>
                    <div class="keypad-button delete" onclick="settings.tapCurrentPin('DEL')">‚å´</div>
                </div>
            </div>
        </div>
    </div>

    <div id="screen-new-pin" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-change-pin')">‚Üê</div>
            <div class="nav-title">–ù–æ–≤—ã–π –ü–ò–ù-–∫–æ–¥</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="pin-container" style="padding: 40px 24px;">
                <h2 class="pin-title">–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–æ–≤—ã–π –ü–ò–ù</h2>
                <p class="pin-subtitle">–í–≤–µ–¥–∏—Ç–µ 4 —Ü–∏—Ñ—Ä—ã –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞ –¥–æ—Å—Ç—É–ø–∞</p>
                <div class="pin-dots">
                    <div class="pin-dot" id="new-pin-0"></div>
                    <div class="pin-dot" id="new-pin-1"></div>
                    <div class="pin-dot" id="new-pin-2"></div>
                    <div class="pin-dot" id="new-pin-3"></div>
                </div>
                
                <div class="numeric-keypad">
                    <div class="keypad-button" onclick="settings.tapNewPin('1')">1</div>
                    <div class="keypad-button" onclick="settings.tapNewPin('2')">2</div>
                    <div class="keypad-button" onclick="settings.tapNewPin('3')">3</div>
                    <div class="keypad-button" onclick="settings.tapNewPin('4')">4</div>
                    <div class="keypad-button" onclick="settings.tapNewPin('5')">5</div>
                    <div class="keypad-button" onclick="settings.tapNewPin('6')">6</div>
                    <div class="keypad-button" onclick="settings.tapNewPin('7')">7</div>
                    <div class="keypad-button" onclick="settings.tapNewPin('8')">8</div>
                    <div class="keypad-button" onclick="settings.tapNewPin('9')">9</div>
                    <div class="keypad-button empty"></div>
                    <div class="keypad-button" onclick="settings.tapNewPin('0')">0</div>
                    <div class="keypad-button delete" onclick="settings.tapNewPin('DEL')">‚å´</div>
                </div>
            </div>
        </div>
    </div>

    <div id="screen-confirm-pin" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-new-pin')">‚Üê</div>
            <div class="nav-title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="pin-container" style="padding: 40px 24px;">
                <h2 class="pin-title">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ü–ò–ù</h2>
                <p class="pin-subtitle">–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ü–ò–ù-–∫–æ–¥ –µ—â–µ —Ä–∞–∑</p>
                <div class="pin-dots">
                    <div class="pin-dot" id="confirm-pin-0"></div>
                    <div class="pin-dot" id="confirm-pin-1"></div>
                    <div class="pin-dot" id="confirm-pin-2"></div>
                    <div class="pin-dot" id="confirm-pin-3"></div>
                </div>
                
                <div class="numeric-keypad">
                    <div class="keypad-button" onclick="settings.tapConfirmPin('1')">1</div>
                    <div class="keypad-button" onclick="settings.tapConfirmPin('2')">2</div>
                    <div class="keypad-button" onclick="settings.tapConfirmPin('3')">3</div>
                    <div class="keypad-button" onclick="settings.tapConfirmPin('4')">4</div>
                    <div class="keypad-button" onclick="settings.tapConfirmPin('5')">5</div>
                    <div class="keypad-button" onclick="settings.tapConfirmPin('6')">6</div>
                    <div class="keypad-button" onclick="settings.tapConfirmPin('7')">7</div>
                    <div class="keypad-button" onclick="settings.tapConfirmPin('8')">8</div>
                    <div class="keypad-button" onclick="settings.tapConfirmPin('9')">9</div>
                    <div class="keypad-button empty"></div>
                    <div class="keypad-button" onclick="settings.tapConfirmPin('0')">0</div>
                    <div class="keypad-button delete" onclick="settings.tapConfirmPin('DEL')">‚å´</div>
                </div>
            </div>
        </div>
    </div>

    <div id="screen-currency" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-settings')">‚Üê</div>
            <div class="nav-title">–û—Å–Ω–æ–≤–Ω–∞—è –≤–∞–ª—é—Ç–∞</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="settings-section">
                <div class="settings-item" onclick="settings.selectCurrency('RUB')">
                    <div class="settings-item-content">
                        <div class="settings-icon">üá∑üá∫</div>
                        <div class="settings-text">
                            <div class="settings-name">–†–æ—Å—Å–∏–π—Å–∫–∏–π —Ä—É–±–ª—å (RUB)</div>
                            <div class="settings-description">–û—Å–Ω–æ–≤–Ω–∞—è –≤–∞–ª—é—Ç–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π</div>
                        </div>
                    </div>
                    <div style="color: var(--neon-blue); font-size: 20px;" id="rub-check">‚úì</div>
                </div>
                
                <div class="settings-item" onclick="settings.selectCurrency('USD')">
                    <div class="settings-item-content">
                        <div class="settings-icon">üá∫üá∏</div>
                        <div class="settings-text">
                            <div class="settings-name">–î–æ–ª–ª–∞—Ä –°–®–ê (USD)</div>
                            <div class="settings-description">–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∞—è –≤–∞–ª—é—Ç–∞</div>
                        </div>
                    </div>
                    <div style="color: var(--text-dim); font-size: 20px;" id="usd-check"></div>
                </div>
                
                <div class="settings-item" onclick="settings.selectCurrency('EUR')">
                    <div class="settings-item-content">
                        <div class="settings-icon">üá™üá∫</div>
                        <div class="settings-text">
                            <div class="settings-name">–ï–≤—Ä–æ (EUR)</div>
                            <div class="settings-description">–ï–≤—Ä–æ–ø–µ–π—Å–∫–∞—è –≤–∞–ª—é—Ç–∞</div>
                        </div>
                    </div>
                    <div style="color: var(--text-dim); font-size: 20px;" id="eur-check"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="screen-updates" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-settings')">‚Üê</div>
            <div class="nav-title">–û–±–Ω–æ–≤–ª–µ–Ω–∏—è</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="glass-effect" style="padding: 24px; margin-bottom: 20px; text-align: center;">
                <div style="font-size: 48px; margin-bottom: 16px;">üîÑ</div>
                <div style="font-size: 22px; font-weight: 700; margin-bottom: 8px;" id="current-version">–í–µ—Ä—Å–∏—è 2.0.1</div>
                <div style="font-size: 15px; color: var(--text-dim);" id="last-checked">–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –Ω–∏–∫–æ–≥–¥–∞</div>
            </div>
            
            <div id="updates-list"></div>
            
            <button class="auth-button" onclick="updates.checkForUpdates()" id="check-updates-btn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</button>
            
            <button class="auth-button" style="background: var(--neon-purple); margin-top: 16px;" onclick="updates.viewAllUpdates()">–ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</button>
            
            <div class="glass-effect" style="padding: 20px; margin-top: 30px;">
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</div>
                <div style="font-size: 15px; color: var(--text-dim); line-height: 1.5;">
                    ‚Ä¢ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="auto-update-status">–í—ã–∫–ª—é—á–µ–Ω–æ</span><br>
                    ‚Ä¢ –ö–∞–Ω–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: <span id="update-channel">–°—Ç–∞–±–∏–ª—å–Ω—ã–π</span><br>
                    ‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: <span id="last-check-time">–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞</span>
                </div>
            </div>
        </div>
    </div>

    <div id="screen-all-updates" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-updates')">‚Üê</div>
            <div class="nav-title">–ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div id="all-updates-list"></div>
        </div>
    </div>

    <div id="screen-privacy" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-settings')">‚Üê</div>
            <div class="nav-title">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="settings-section">
                <div class="settings-item" onclick="settings.toggleShowBalance()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üëÅÔ∏è</div>
                        <div class="settings-text">
                            <div class="settings-name">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–∞–ª–∞–Ω—Å</div>
                            <div class="settings-description">–û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å—É–º–º—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="show-balance-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-item" onclick="settings.toggleTransactionHistory()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üìä</div>
                        <div class="settings-text">
                            <div class="settings-name">–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</div>
                            <div class="settings-description">–°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="history-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-item" onclick="settings.toggleAnalytics()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üìà</div>
                        <div class="settings-text">
                            <div class="settings-name">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</div>
                            <div class="settings-description">–û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∞–Ω–æ–Ω–∏–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="analytics-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-item" onclick="settings.toggleLocation()">
                    <div class="settings-item-content">
                        <div class="settings-icon">üìç</div>
                        <div class="settings-text">
                            <div class="settings-name">–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è</div>
                            <div class="settings-description">–û–ø—Ä–µ–¥–µ–ª—è—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</div>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="location-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="glass-effect" style="padding: 20px; margin-top: 30px; margin-bottom: 20px;">
                <div style="font-size: 15px; color: var(--text-dim); line-height: 1.5;">
                    –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –±–∞–Ω–∫–æ–≤—Å–∫–æ–π —Ç–∞–π–Ω–æ–π. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–∞—à–µ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
                </div>
            </div>
            
            <button class="auth-button" style="background: var(--neon-purple);" onclick="settings.exportData()">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
            
            <button class="auth-button" style="background: var(--neon-red); margin-top: 16px;" onclick="settings.deleteAccount()">–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
        </div>
    </div>

    <div id="screen-support" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-settings')">‚Üê</div>
            <div class="nav-title">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="glass-effect" style="padding: 24px; margin-bottom: 20px; text-align: center;">
                <div style="font-size: 48px; margin-bottom: 16px;">üí¨</div>
                <div style="font-size: 22px; font-weight: 700; margin-bottom: 8px;">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                <div style="font-size: 15px; color: var(--text-dim);">–ú—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å</div>
            </div>
            
            <textarea class="textarea-input" id="support-message" placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É –∏–ª–∏ –≤–æ–ø—Ä–æ—Å..."></textarea>
            
            <button class="auth-button" onclick="settings.sendSupportMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å</button>
            
            <div class="glass-effect" style="padding: 20px; margin-top: 30px;">
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">–ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏</div>
                <div style="font-size: 15px; color: var(--text-dim); line-height: 1.5;">
                    Email: support@k-bank.ru<br>
                    Telegram: @kbank_support<br>
                    –ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã: 24/7
                </div>
            </div>
        </div>
    </div>

    <div id="screen-about" class="screen">
        <div class="nav-bar">
            <div class="nav-button" onclick="view.nav('screen-settings')">‚Üê</div>
            <div class="nav-title">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</div>
            <div style="width: 44px;"></div>
        </div>
        <div class="content">
            <div class="glass-effect" style="padding: 24px; margin-bottom: 20px; text-align: center;">
                <div style="font-size: 64px; margin-bottom: 16px;">üè¶</div>
                <div style="font-size: 28px; font-weight: 800; margin-bottom: 8px;">–ö-–ë–∞–Ω–∫</div>
                <div style="font-size: 17px; color: var(--text-dim); margin-bottom: 4px;" id="app-version">–í–µ—Ä—Å–∏—è 2.0.1</div>
                <div style="font-size: 15px; color: var(--text-dim;" id="app-build">Build 2024.01</div>
            </div>
            
            <div class="glass-effect" style="padding: 20px; margin-bottom: 20px;">
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">–û —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–µ</div>
                <div style="font-size: 15px; color: var(--text-dim); line-height: 1.5;">
                    –ö-–ë–∞–Ω–∫ ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –±–∞–Ω–∫–æ–≤—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –≤ —Å—Ç–∏–ª–µ Apple. –ú—ã —Å—Ç—Ä–µ–º–∏–º—Å—è —Å–¥–µ–ª–∞—Ç—å –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ —É—Å–ª—É–≥–∏ –ø—Ä–æ—Å—Ç—ã–º–∏, –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –∏ —É–¥–æ–±–Ω—ã–º–∏.
                </div>
            </div>
            
            <div class="glass-effect" style="padding: 20px; margin-bottom: 20px;">
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</div>
                <div style="font-size: 15px; color: var(--text-dim); line-height: 1.5;">
                    ‚Ä¢ Firebase Realtime Database<br>
                    ‚Ä¢ Telegram Bot API<br>
                    ‚Ä¢ HTML5 QR Code Scanner<br>
                    ‚Ä¢ Glassmorphism UI Design
                </div>
            </div>
            
            <button class="auth-button" style="background: var(--neon-blue);" onclick="settings.checkUpdates()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</button>
            
            <div style="text-align: center; margin-top: 30px; color: var(--text-dim); font-size: 13px;">
                ¬© 2024 –ö-–ë–∞–Ω–∫. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
            </div>
        </div>
    </div>

    <script>
        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –¢–ï–•–û–ë–°–õ–£–ñ–ò–í–ê–ù–ò–Ø
        const MAINTENANCE_MODE = true; // –ò–ó–ú–ï–ù–ò–¢–ï –ù–ê true –î–õ–Ø –í–ö–õ–Æ–ß–ï–ù–ò–Ø –†–ï–ñ–ò–ú–ê –¢–ï–•–û–ë–°–õ–£–ñ–ò–í–ê–ù–ò–Ø
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const TG_TOKEN = '8548215166:AAGVqNJxcZe_2bzWiaJIAFz57WRsIYjZQpM'; 
        const TG_ADMIN_ID = '7597506775';
        const config = { 
            apiKey: "AIzaSyA3J7KnUgxUHZigwRKmndm7xyxJeeLCrxg", 
            databaseURL: "https://webapp-b7149-default-rtdb.europe-west1.firebasedatabase.app", 
            projectId: "webapp-b7149" 
        };
        
        firebase.initializeApp(config);
        const rtdb = firebase.database();

        // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        let state = { 
            all: [], 
            user: null, 
            pin: "", 
            otp: "", 
            generatedOtp: "",
            currentCardType: null,
            settings: {
                biometric: false,
                notifications: true,
                darkMode: true,
                currency: 'RUB',
                snow: true,
                showBalance: true,
                history: true,
                analytics: false,
                pushNotifications: false,
                sound: false,
                vibration: false,
                autoUpdate: false,
                location: false
            },
            appVersion: '2.0.1',
            appBuild: '2024.01'
        };
        
        let scanner = null;
        let currentPinInput = "";
        let newPinInput = "";
        let confirmPinInput = "";
        let snowAnimationId = null;

        // –°–Ω–µ–∂–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
        const canvas = document.getElementById('snow-canvas');
        const ctx = canvas.getContext('2d');
        let flakes = [];
        
        function initSnow() {
            resize();
            flakes = [];
            for(let i = 0; i < 80; i++) {
                flakes.push({ 
                    x: Math.random() * canvas.width, 
                    y: Math.random() * canvas.height, 
                    r: Math.random() * 2 + 0.5, 
                    v: Math.random() * 0.8 + 0.2, 
                    o: Math.random() * 0.5 + 0.3 
                });
            }
            drawSnow();
        }
        
        function resize() { 
            canvas.width = window.innerWidth; 
            canvas.height = window.innerHeight; 
        }
        
        window.onresize = resize;
        
        function drawSnow() {
            if (!state.settings.snow) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                return;
            }
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            flakes.forEach(f => {
                ctx.fillStyle = `rgba(255, 255, 255, ${f.o})`;
                ctx.beginPath();
                ctx.arc(f.x, f.y, f.r, 0, Math.PI * 2);
                ctx.fill();
                f.y += f.v;
                if(f.y > canvas.height) f.y = -5;
            });
            snowAnimationId = requestAnimationFrame(drawSnow);
        }
        
        // –§–£–ù–ö–¶–ò–Ø –¢–ï–•–û–ë–°–õ–£–ñ–ò–í–ê–ù–ò–Ø
        function checkMaintenanceMode() {
            if (MAINTENANCE_MODE === true) {
                // –ü–æ–∫–∞–∑–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                document.getElementById('maintenance-overlay').style.display = 'flex';
                
                // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.style.display = 'none';
                    screen.classList.remove('active');
                });
                
                // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
                document.querySelectorAll('.modal-overlay, .qr-scanner').forEach(modal => {
                    modal.style.display = 'none';
                });
                
                // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
                document.getElementById('maintenance-message').innerText = '–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, –∑–∞–π–¥–∏—Ç–µ –ø–æ–∑–∂–µ';
                
                // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–ª–∏–∫–∏
                document.body.style.pointerEvents = 'none';
                document.getElementById('maintenance-overlay').style.pointerEvents = 'auto';
                
                console.log('–†–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –≤–∫–ª—é—á–µ–Ω');
            } else {
                // –°–∫—Ä—ã—Ç—å –æ–≤–µ—Ä–ª–µ–π —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                document.getElementById('maintenance-overlay').style.display = 'none';
                
                // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–ª–∏–∫–∏
                document.body.style.pointerEvents = 'auto';
                
                console.log('–†–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –≤—ã–∫–ª—é—á–µ–Ω');
            }
        }
        
        // View –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
        const view = {
            nav: (screenId) => {
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true && screenId !== 'screen-auth') {
                    checkMaintenanceMode();
                    return;
                }
                
                document.querySelectorAll('.screen').forEach(s => {
                    s.classList.remove('active');
                    setTimeout(() => {
                        if(!s.classList.contains('active')) {
                            s.style.display = 'none';
                        }
                    }, 300);
                });
                
                const targetScreen = document.getElementById(screenId);
                targetScreen.style.display = 'flex';
                
                setTimeout(() => {
                    targetScreen.classList.add('active');
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å —Ç–∞–±—ã
                    document.querySelectorAll('.tab-item').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    if(screenId === 'screen-home') {
                        document.querySelector('.tab-item').classList.add('active');
                        view.loadDashboard();
                    }
                    
                    if(screenId === 'screen-history') {
                        document.querySelectorAll('.tab-item')[1].classList.add('active');
                        view.loadFullHistory();
                    }
                    
                    if(screenId === 'screen-settings') {
                        document.querySelectorAll('.tab-item')[2].classList.add('active');
                        view.loadSettings();
                    }
                    
                    if(screenId === 'screen-profile') {
                        view.loadProfile();
                    }
                    
                    if(screenId === 'screen-updates') {
                        updates.loadUpdatesScreen();
                    }
                    
                    if(screenId === 'screen-all-updates') {
                        updates.loadAllUpdates();
                    }
                }, 50);
            },
            
            loadDashboard: () => {
                if(!state.user) return;
                
                const user = state.user;
                
                // –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –∫–∞—Ä—Ç
                let cardsHTML = '';
                
                // –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–∞
                const balanceDisplay = state.settings.showBalance ? 
                    `${(user.balance || 0).toLocaleString()} ‚ÇΩ` : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚ÇΩ';
                
                cardsHTML += `
                    <div class="glass-effect balance-card" onclick="view.showCardHistory('main', '–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–∞', ${user.balance || 0})">
                        <div class="balance-card-header">
                            <div class="card-name">–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–∞</div>
                            <div class="card-number">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 4432</div>
                        </div>
                        <div class="balance-amount">${balanceDisplay}</div>
                        <div class="balance-change">+${(user.balance || 0) > 5000 ? user.balance - 5000 : 0} ‚ÇΩ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è</div>
                    </div>
                `;
                
                // –î–æ–ª–ª–∞—Ä–æ–≤–∞—è –∫–∞—Ä—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
                if(user.usd && user.usd > 0) {
                    const usdDisplay = state.settings.showBalance ? 
                        `${user.usd.toFixed(2)} $` : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢ $';
                    
                    cardsHTML += `
                        <div class="glass-effect balance-card" onclick="view.showCardHistory('usd', '–î–æ–ª–ª–∞—Ä–æ–≤–∞—è –∫–∞—Ä—Ç–∞', ${user.usd})">
                            <div class="balance-card-header">
                                <div class="card-name">VISA Digital</div>
                                <div class="card-number">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 8801</div>
                            </div>
                            <div class="balance-amount">${usdDisplay}</div>
                            <div class="balance-change">‚âà ${Math.round(user.usd * 91.2).toLocaleString()} ‚ÇΩ</div>
                        </div>
                    `;
                }
                
                // –ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
                if(user.hasCredit) {
                    const creditDisplay = state.settings.showBalance ? 
                        `${(user.creditBalance || 0).toLocaleString()} ‚ÇΩ` : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚ÇΩ';
                    
                    cardsHTML += `
                        <div class="glass-effect balance-card" onclick="view.showCardHistory('credit', '–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞', ${user.creditBalance || 0})">
                            <div class="balance-card-header">
                                <div class="card-name">GOLD Credit</div>
                                <div class="card-number">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 0001</div>
                            </div>
                            <div class="balance-amount">${creditDisplay}</div>
                            <div class="balance-change negative">–ö—Ä–µ–¥–∏—Ç–Ω—ã–π –ª–∏–º–∏—Ç</div>
                        </div>
                    `;
                }
                
                document.getElementById('balance-cards').innerHTML = cardsHTML;
                
                // –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
                view.loadRecentTransactions();
            },
            
            loadRecentTransactions: () => {
                if(!state.user || !state.settings.history) {
                    document.getElementById('recent-transactions').innerHTML = `
                        <div style="text-align: center; padding: 40px 20px; color: var(--text-dim);">
                            <div style="font-size: 48px; margin-bottom: 16px;">üìä</div>
                            <div style="font-size: 16px; margin-bottom: 8px;">–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –æ—Ç–∫–ª—é—á–µ–Ω–∞</div>
                            <div style="font-size: 14px;">–í–∫–ª—é—á–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö</div>
                        </div>
                    `;
                    return;
                }
                
                rtdb.ref(`history/${state.user.fbKey}`).once('value').then(snapshot => {
                    const data = snapshot.val();
                    let transactionsHTML = '';
                    
                    if(data) {
                        const transactions = Object.keys(data).map(key => ({
                            id: key,
                            ...data[key]
                        }));
                        
                        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ (–æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫)
                        transactions.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
                        
                        // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ 5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö
                        const recent = transactions.slice(0, 5);
                        
                        recent.forEach(trans => {
                            const isPlus = trans.type === 'plus';
                            const amountClass = isPlus ? 'amount-positive' : 
                                              trans.status === 'wait' ? 'amount-pending' : 'amount-negative';
                            const amountPrefix = isPlus ? '+' : '-';
                            const amountDisplay = state.settings.showBalance ? 
                                `${amountPrefix}${trans.val.toLocaleString()} ${trans.unit || '‚ÇΩ'}` : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                            
                            transactionsHTML += `
                                <div class="transaction-item">
                                    <div class="transaction-icon">${trans.ico || 'üí≥'}</div>
                                    <div class="transaction-info">
                                        <div class="transaction-title">${trans.title}</div>
                                        <div class="transaction-description">
                                            ${trans.status === 'wait' ? '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ' : '–ó–∞–≤–µ—Ä—à–µ–Ω–æ'} ‚Ä¢ 
                                            ${new Date(trans.timestamp || Date.now()).toLocaleDateString('ru-RU')}
                                        </div>
                                    </div>
                                    <div class="transaction-amount ${amountClass}">
                                        ${amountDisplay}
                                    </div>
                                </div>
                            `;
                        });
                    } else {
                        transactionsHTML = `
                            <div style="text-align: center; padding: 40px 20px; color: var(--text-dim);">
                                <div style="font-size: 48px; margin-bottom: 16px;">üìä</div>
                                <div style="font-size: 16px; margin-bottom: 8px;">–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π</div>
                                <div style="font-size: 14px;">–°–æ–≤–µ—Ä—à–∏—Ç–µ –ø–µ—Ä–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é</div>
                            </div>
                        `;
                    }
                    
                    document.getElementById('recent-transactions').innerHTML = transactionsHTML;
                });
            },
            
            loadFullHistory: () => {
                if(!state.user || !state.settings.history) {
                    document.getElementById('full-history-list').innerHTML = `
                        <div style="text-align: center; padding: 100px 20px; color: var(--text-dim);">
                            <div style="font-size: 48px; margin-bottom: 20px;">üìä</div>
                            <div style="font-size: 18px; margin-bottom: 10px;">–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –æ—Ç–∫–ª—é—á–µ–Ω–∞</div>
                            <div style="font-size: 14px;">–í–∫–ª—é—á–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏</div>
                        </div>
                    `;
                    return;
                }
                
                const list = document.getElementById('full-history-list');
                list.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
                
                rtdb.ref(`history/${state.user.fbKey}`).on('value', snapshot => {
                    const data = snapshot.val();
                    let historyHTML = '';
                    
                    if(data) {
                        const transactions = Object.keys(data).map(key => ({
                            id: key,
                            ...data[key]
                        }));
                        
                        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ (–æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫)
                        transactions.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
                        
                        transactions.forEach(trans => {
                            const isPlus = trans.type === 'plus';
                            const amountClass = isPlus ? 'amount-positive' : 
                                              trans.status === 'wait' ? 'amount-pending' : 'amount-negative';
                            const amountPrefix = isPlus ? '+' : '-';
                            const amountDisplay = state.settings.showBalance ? 
                                `${amountPrefix}${trans.val.toLocaleString()} ${trans.unit || '‚ÇΩ'}` : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                            
                            historyHTML += `
                                <div class="transaction-item">
                                    <div class="transaction-icon">${trans.ico || 'üí≥'}</div>
                                    <div class="transaction-info">
                                        <div class="transaction-title">${trans.title}</div>
                                        <div class="transaction-description">
                                            ${trans.status === 'wait' ? '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ' : '–ó–∞–≤–µ—Ä—à–µ–Ω–æ'} ‚Ä¢ 
                                            ${new Date(trans.timestamp || Date.now()).toLocaleDateString('ru-RU')}
                                        </div>
                                    </div>
                                    <div class="transaction-amount ${amountClass}">
                                        ${amountDisplay}
                                    </div>
                                </div>
                            `;
                        });
                    } else {
                        historyHTML = `
                            <div style="text-align: center; padding: 100px 20px; color: var(--text-dim);">
                                <div style="font-size: 48px; margin-bottom: 20px;">üìä</div>
                                <div style="font-size: 18px; margin-bottom: 10px;">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</div>
                                <div style="font-size: 14px;">–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤—Å–µ –≤–∞—à–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏</div>
                            </div>
                        `;
                    }
                    
                    list.innerHTML = historyHTML;
                });
            },
            
            showCardHistory: (cardType, cardName, balance) => {
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                state.currentCardType = cardType;
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–∞—Ä—Ç—É
                const cardDisplay = document.getElementById('selected-card-display');
                const balanceDisplay = state.settings.showBalance ? 
                    (cardType === 'usd' ? balance.toFixed(2) + ' $' : balance.toLocaleString() + ' ‚ÇΩ') : 
                    (cardType === 'usd' ? '‚Ä¢‚Ä¢‚Ä¢‚Ä¢ $' : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚ÇΩ');
                
                const cardHTML = `
                    <div style="margin-bottom: 8px; font-size: 15px; color: var(--text-dim);">${cardName}</div>
                    <div style="font-size: 32px; font-weight: 800; margin-bottom: 12px;">
                        ${balanceDisplay}
                    </div>
                    <div style="font-size: 13px; color: var(--text-dim);">
                        ${cardType === 'usd' ? '‚âà ' + Math.round(balance * 91.2).toLocaleString() + ' ‚ÇΩ' : 
                          cardType === 'credit' ? '–ö—Ä–µ–¥–∏—Ç–Ω—ã–π –ª–∏–º–∏—Ç' : '–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Å–Ω—è—Ç–∏—è'}
                    </div>
                `;
                cardDisplay.innerHTML = cardHTML;
                
                // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫
                document.getElementById('card-history-title').innerText = cardName;
                
                // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ –∫–∞—Ä—Ç–µ
                const historyList = document.getElementById('card-history-list');
                historyList.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
                
                rtdb.ref(`history/${state.user.fbKey}`).once('value').then(snapshot => {
                    const data = snapshot.val();
                    let historyHTML = '';
                    
                    if(data) {
                        const transactions = Object.keys(data).map(key => ({
                            id: key,
                            ...data[key]
                        }));
                        
                        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É –∫–∞—Ä—Ç—ã
                        const filteredTransactions = transactions.filter(trans => {
                            if(cardType === 'usd') {
                                return trans.unit === '$';
                            } else if(cardType === 'credit') {
                                return trans.title.includes('–ö—Ä–µ–¥–∏—Ç') || trans.title.includes('Gold');
                            } else {
                                return !trans.unit || trans.unit === '‚ÇΩ';
                            }
                        });
                        
                        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ
                        filteredTransactions.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
                        
                        if(filteredTransactions.length > 0) {
                            filteredTransactions.forEach(trans => {
                                const isPlus = trans.type === 'plus';
                                const amountClass = isPlus ? 'amount-positive' : 
                                                  trans.status === 'wait' ? 'amount-pending' : 'amount-negative';
                                const amountPrefix = isPlus ? '+' : '-';
                                const amountDisplay = state.settings.showBalance ? 
                                    `${amountPrefix}${trans.val.toLocaleString()} ${trans.unit || '‚ÇΩ'}` : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                                
                                historyHTML += `
                                    <div class="transaction-item" style="margin-bottom: 12px;">
                                        <div class="transaction-icon">${trans.ico || 'üí≥'}</div>
                                        <div class="transaction-info">
                                            <div class="transaction-title">${trans.title}</div>
                                            <div class="transaction-description">
                                                ${trans.status === 'wait' ? '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ' : '–ó–∞–≤–µ—Ä—à–µ–Ω–æ'} ‚Ä¢ 
                                                ${new Date(trans.timestamp || Date.now()).toLocaleDateString('ru-RU')}
                                            </div>
                                        </div>
                                        <div class="transaction-amount ${amountClass}">
                                            ${amountDisplay}
                                        </div>
                                    </div>
                                `;
                            });
                        } else {
                            historyHTML = `
                                <div style="text-align: center; padding: 100px 20px; color: var(--text-dim);">
                                    <div style="font-size: 48px; margin-bottom: 20px;">üí≥</div>
                                    <div style="font-size: 18px; margin-bottom: 10px;">–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ —ç—Ç–æ–π –∫–∞—Ä—Ç–µ</div>
                                    <div style="font-size: 14px;">–û–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç—ã</div>
                                </div>
                            `;
                        }
                    } else {
                        historyHTML = `
                            <div style="text-align: center; padding: 100px 20px; color: var(--text-dim);">
                                <div style="font-size: 48px; margin-bottom: 20px;">üí≥</div>
                                <div style="font-size: 18px; margin-bottom: 10px;">–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ —ç—Ç–æ–π –∫–∞—Ä—Ç–µ</div>
                                <div style="font-size: 14px;">–û–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç—ã</div>
                            `;
                        `;
                    }
                    
                    historyList.innerHTML = historyHTML;
                });
                
                // –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —ç–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏ –∫–∞—Ä—Ç—ã
                view.nav('screen-card-history');
            },
            
            loadProfile: () => {
                if(!state.user) return;
                
                const user = state.user;
                
                // –ê–≤–∞—Ç–∞—Ä
                document.getElementById('profile-avatar').innerText = user.name[0].toUpperCase();
                
                // –ò–º—è –∏ ID
                document.getElementById('profile-name').innerText = user.name;
                document.getElementById('profile-tg-id').innerText = `ID: ${user.telegramId}`;
                
                // –ë–∞–ª–∞–Ω—Å—ã
                const totalBalance = state.settings.showBalance ? 
                    `${(user.balance || 0).toLocaleString()} ‚ÇΩ` : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚ÇΩ';
                const usdBalance = state.settings.showBalance ? 
                    `${(user.usd || 0).toFixed(2)} $` : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢ $';
                const creditBalance = state.settings.showBalance ? 
                    (user.hasCredit ? `${(user.creditBalance || 0).toLocaleString()} ‚ÇΩ` : '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω') : 
                    (user.hasCredit ? '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚ÇΩ' : '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω');
                
                document.getElementById('profile-total-balance').innerText = totalBalance;
                document.getElementById('profile-usd').innerText = usdBalance;
                document.getElementById('profile-credit').innerText = creditBalance;
            },
            
            loadSettings: () => {
                // –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ localStorage
                const savedSettings = localStorage.getItem('kbank_settings');
                if(savedSettings) {
                    state.settings = JSON.parse(savedSettings);
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏
                document.getElementById('biometric-toggle').checked = state.settings.biometric;
                document.getElementById('notifications-toggle').checked = state.settings.notifications;
                document.getElementById('dark-mode-toggle').checked = state.settings.darkMode;
                document.getElementById('snow-toggle').checked = state.settings.snow;
                document.getElementById('show-balance-toggle').checked = state.settings.showBalance;
                document.getElementById('history-toggle').checked = state.settings.history;
                document.getElementById('analytics-toggle').checked = state.settings.analytics;
                document.getElementById('push-notifications-toggle').checked = state.settings.pushNotifications;
                document.getElementById('sound-toggle').checked = state.settings.sound;
                document.getElementById('vibration-toggle').checked = state.settings.vibration;
                document.getElementById('auto-update-toggle').checked = state.settings.autoUpdate;
                document.getElementById('location-toggle').checked = state.settings.location;
                
                // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∞–ª—é—Ç—ã
                const currencyNames = {
                    'RUB': '–†–æ—Å—Å–∏–π—Å–∫–∏–π —Ä—É–±–ª—å (RUB)',
                    'USD': '–î–æ–ª–ª–∞—Ä –°–®–ê (USD)',
                    'EUR': '–ï–≤—Ä–æ (EUR)'
                };
                document.getElementById('currency-display').innerText = currencyNames[state.settings.currency];
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Å–Ω–µ–≥
                if(state.settings.snow && !snowAnimationId) {
                    initSnow();
                } else if(!state.settings.snow && snowAnimationId) {
                    cancelAnimationFrame(snowAnimationId);
                    snowAnimationId = null;
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
                
               // –û–±–Ω–æ–≤–∏—Ç—å –≥–∞–ª–æ—á–∫–∏ –≤ –≤—ã–±–æ—Ä–µ –≤–∞–ª—é—Ç—ã
                document.getElementById('rub-check').innerHTML = state.settings.currency === 'RUB' ? '‚úì' : '';
                document.getElementById('usd-check').innerHTML = state.settings.currency === 'USD' ? '‚úì' : '';
                document.getElementById('eur-check').innerHTML = state.settings.currency === 'EUR' ? '‚úì' : '';
            },
            
            showSuccess: (title, amount, message, icon = '‚úÖ') => {
                document.getElementById('success-icon').innerText = icon;
                document.getElementById('suc-h').innerText = title;
                document.getElementById('suc-val').innerText = amount;
                document.getElementById('suc-p').innerText = message;
                document.getElementById('modal-success').style.display = 'block';
            },
            
            hideSuccess: () => {
                document.getElementById('modal-success').style.display = 'none';
            },
            
            showConfirm: (title, text, icon, callback) => {
                document.getElementById('confirm-icon').innerText = icon;
                document.getElementById('confirm-title').innerText = title;
                document.getElementById('confirm-text').innerText = text;
                
                const btn = document.getElementById('confirm-action-btn');
                btn.onclick = callback;
                
                document.getElementById('modal-confirm').style.display = 'block';
            }
        };

        // –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const logic = {
            requestOTP: () => {
                const tgId = document.getElementById('auth-tg-id').value.trim();
                
                if(!tgId || tgId.length < 5) {
                    alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π Telegram ID');
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 6-–∑–Ω–∞—á–Ω–æ–≥–æ OTP
                state.generatedOtp = Math.floor(100000 + Math.random() * 900000).toString();
                state.otp = "";
                
                // –°–±—Ä–æ—Å OTP —Ç–æ—á–µ–∫
                for(let i = 0; i < 6; i++) {
                    document.getElementById(`otp-${i}`).classList.remove('active');
                }
                
                // –û—Ç–ø—Ä–∞–≤–∏—Ç—å OTP –≤ Telegram
                fetch(`https://api.telegram.org/bot${TG_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: tgId,
                        text: `üîê –í–∞—à –∫–æ–¥ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ö-–ë–∞–Ω–∫: ${state.generatedOtp}\n\n–ù–∏–∫–æ–º—É –Ω–µ —Å–æ–æ–±—â–∞–π—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥!`
                    })
                }).then(res => res.json()).then(data => {
                    if(data.ok) {
                        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å TG ID –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
                        state.tempTgId = tgId;
                        view.nav('screen-otp-entry');
                    } else {
                        alert('–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram ID.');
                    }
                }).catch(err => {
                    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', err);
                    alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.');
                });
            },
            
            tapOtp: (digit) => {
                if(digit === 'DEL') {
                    state.otp = state.otp.slice(0, -1);
                } else if(state.otp.length < 6) {
                    state.otp += digit;
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫–∏
                for(let i = 0; i < 6; i++) {
                    const dot = document.getElementById(`otp-${i}`);
                    if(i < state.otp.length) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å–ª–∏ –∫–æ–¥ –≤–≤–µ–¥–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
                if(state.otp.length === 6) {
                    if(state.otp === state.generatedOtp) {
                        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        logic.checkRegistration(state.tempTgId);
                    } else {
                        alert('–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                        state.otp = "";
                        for(let i = 0; i < 6; i++) {
                            document.getElementById(`otp-${i}`).classList.remove('active');
                        }
                    }
                }
            },
            
            checkRegistration: (tgId) => {
                rtdb.ref('users').once('value').then(snapshot => {
                    const users = snapshot.val();
                    let foundUser = null;
                    let userKey = null;
                    
                    if(users) {
                        Object.keys(users).forEach(key => {
                            if(users[key].telegramId == tgId) {
                                foundUser = users[key];
                                userKey = key;
                            }
                        });
                    }
                    
                    if(foundUser) {
                        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ü–ò–ù
                        state.user = { ...foundUser, fbKey: userKey };
                        document.getElementById('pin-user-name').innerText = `–î–ª—è ${foundUser.name}`;
                        state.pin = "";
                        for(let i = 0; i < 4; i++) {
                            document.getElementById(`pin-${i}`).classList.remove('active');
                        }
                        view.nav('screen-pin-entry');
                    } else {
                        // –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                        alert('–ê–∫–∫–∞—É–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å.');
                        view.nav('screen-register');
                    }
                });
            },
            
            tapPin: (digit) => {
                if(digit === 'DEL') {
                    state.pin = state.pin.slice(0, -1);
                } else if(state.pin.length < 4) {
                    state.pin += digit;
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫–∏
                for(let i = 0; i < 4; i++) {
                    const dot = document.getElementById(`pin-${i}`);
                    if(i < state.pin.length) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å–ª–∏ –ü–ò–ù –≤–≤–µ–¥–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
                if(state.pin.length === 4) {
                    if(state.pin === state.user.pin) {
                        // –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
                        view.nav('screen-home');
                        view.loadDashboard();
                        
                        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–µ—Å—Å–∏—é
                        localStorage.setItem('kbank_session', JSON.stringify({
                            userId: state.user.fbKey,
                            timestamp: Date.now()
                        }));
                    } else {
                        alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ü–ò–ù-–∫–æ–¥!');
                        state.pin = "";
                        for(let i = 0; i < 4; i++) {
                            document.getElementById(`pin-${i}`).classList.remove('active');
                        }
                    }
                }
            },
            
            registerRequest: () => {
                const tgId = document.getElementById('reg-tg-id').value.trim();
                const name = document.getElementById('reg-name').value.trim();
                const pin = document.getElementById('reg-pin').value.trim();
                
                if(!tgId || tgId.length < 5) {
                    alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π Telegram ID');
                    return;
                }
                
                if(!name || name.length < 2) {
                    alert('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è');
                    return;
                }
                
                if(!pin || pin.length !== 4 || isNaN(pin)) {
                    alert('–ü–ò–ù-–∫–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ 4 —Ü–∏—Ñ—Ä');
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                rtdb.ref('users').once('value').then(snapshot => {
                    const users = snapshot.val();
                    let alreadyRegistered = false;
                    
                    if(users) {
                        Object.keys(users).forEach(key => {
                            if(users[key].telegramId == tgId) {
                                alreadyRegistered = true;
                            }
                        });
                    }
                    
                    if(alreadyRegistered) {
                        alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º Telegram ID —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω.');
                        return;
                    }
                    
                    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
                    const requestId = Date.now().toString();
                    rtdb.ref(`requests/${requestId}`).set({
                        telegramId: tgId,
                        name: name,
                        pin: pin,
                        timestamp: Date.now(),
                        status: 'pending'
                    });
                    
                    // –£–≤–µ–¥–æ–º–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                    fetch(`https://api.telegram.org/bot${TG_TOKEN}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            chat_id: TG_ADMIN_ID,
                            text: `üìã –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é:\n\nüë§ –ò–º—è: ${name}\nüì± Telegram ID: ${tgId}\nüÜî ID –∑–∞—è–≤–∫–∏: ${requestId}\n\n–î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.`
                        })
                    });
                    
                    alert('–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram.');
                    view.nav('screen-auth');
                });
            },
            
            logout: () => {
                view.showConfirm(
                    '–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?',
                    '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏? –î–ª—è –≤—Ö–æ–¥–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–Ω–æ–≤–∞ –≤–≤–µ—Å—Ç–∏ –ü–ò–ù-–∫–æ–¥.',
                    'üö™',
                    () => {
                        state.user = null;
                        state.pin = "";
                        localStorage.removeItem('kbank_session');
                        document.getElementById('modal-confirm').style.display = 'none';
                        view.nav('screen-auth');
                    }
                );
            }
        };

        // –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
        const bank = {
            openScanner: () => {
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                document.getElementById('qr-screen').style.display = 'block';
                
                if(!scanner) {
                    scanner = new Html5Qrcode("reader");
                    
                    scanner.start(
                        { facingMode: "environment" },
                        {
                            fps: 10,
                            qrbox: { width: 250, height: 250 }
                        },
                        (decodedText) => {
                            // QR –∫–æ–¥ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω
                            bank.processQR(decodedText);
                        },
                        (errorMessage) => {
                            // –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                        }
                    ).catch(err => {
                        console.error('–û—à–∏–±–∫–∞ —Å–∫–∞–Ω–µ—Ä–∞:', err);
                        alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–º–µ—Ä—É');
                        bank.closeScanner();
                    });
                }
            },
            
            closeScanner: () => {
                if(scanner) {
                    scanner.stop().then(() => {
                        scanner.clear();
                        document.getElementById('qr-screen').style.display = 'none';
                    }).catch(err => {
                        console.error('–û—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∫–∞–Ω–µ—Ä–∞:', err);
                        document.getElementById('qr-screen').style.display = 'none';
                    });
                } else {
                    document.getElementById('qr-screen').style.display = 'none';
                }
            },
            
            processQR: (qrData) => {
                try {
                    const data = JSON.parse(qrData);
                    
                    if(data.type === 'payment' && data.amount) {
                        bank.closeScanner();
                        
                        document.getElementById('qr-pay-sum').innerText = data.amount + ' ‚ÇΩ';
                        document.getElementById('modal-qr-pay').style.display = 'block';
                        
                        document.getElementById('confirm-qr-btn').onclick = () => {
                            bank.makeQRPayment(data.amount, data.description || '–û–ø–ª–∞—Ç–∞ –ø–æ QR-–∫–æ–¥—É');
                        };
                    }
                } catch(e) {
                    alert('–ù–µ–≤–µ—Ä–Ω—ã–π QR-–∫–æ–¥');
                }
            },
            
            makeQRPayment: (amount, description) => {
                if(!state.user || amount <= 0) return;
                
                if(state.user.balance < amount) {
                    alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ —Å—á–µ—Ç–µ');
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
                const newBalance = state.user.balance - amount;
                rtdb.ref(`users/${state.user.fbKey}/balance`).set(newBalance);
                state.user.balance = newBalance;
                
                // –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é
                const historyId = Date.now().toString();
                rtdb.ref(`history/${state.user.fbKey}/${historyId}`).set({
                    title: description,
                    val: amount,
                    type: 'minus',
                    status: 'done',
                    timestamp: Date.now(),
                    ico: 'üì±'
                });
                
                document.getElementById('modal-qr-pay').style.display = 'none';
                
                view.showSuccess(
                    '–û–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–∞',
                    `-${amount} ‚ÇΩ`,
                    '–°—Ä–µ–¥—Å—Ç–≤–∞ —Å–ø–∏—Å–∞–Ω—ã —Å –≤–∞—à–µ–≥–æ —Å—á–µ—Ç–∞',
                    '‚úÖ'
                );
                
                // –û–±–Ω–æ–≤–∏—Ç—å dashboard
                setTimeout(() => view.loadDashboard(), 1000);
            },
            
            send: () => {
                const target = document.getElementById('tr-target').value.trim();
                const amount = parseFloat(document.getElementById('tr-val').value);
                const message = document.getElementById('tr-msg').value.trim();
                
                if(!target || !amount || amount <= 0) {
                    alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
                    return;
                }
                
                if(state.user.balance < amount) {
                    alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ —Å—á–µ—Ç–µ');
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                // –ü–æ–∏—Å–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª—è
                rtdb.ref('users').once('value').then(snapshot => {
                    const users = snapshot.val();
                    let receiver = null;
                    let receiverKey = null;
                    
                    if(users) {
                        Object.keys(users).forEach(key => {
                            const user = users[key];
                            if(user.telegramId == target || user.name.toLowerCase().includes(target.toLowerCase())) {
                                receiver = user;
                                receiverKey = key;
                            }
                        });
                    }
                    
                    if(!receiver) {
                        alert('–ü–æ–ª—É—á–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                        return;
                    }
                    
                    // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞
                    view.showConfirm(
                        '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥',
                        `–ü–µ—Ä–µ–≤–æ–¥ ${amount.toLocaleString()} ‚ÇΩ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${receiver.name}`,
                        'üí∏',
                        () => {
                            // –°–ø–∏—Å–∞—Ç—å —É –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
                            const senderNewBalance = state.user.balance - amount;
                            rtdb.ref(`users/${state.user.fbKey}/balance`).set(senderNewBalance);
                            state.user.balance = senderNewBalance;
                            
                            // –ó–∞—á–∏—Å–ª–∏—Ç—å –ø–æ–ª—É—á–∞—Ç–µ–ª—é
                            const receiverNewBalance = (receiver.balance || 0) + amount;
                            rtdb.ref(`users/${receiverKey}/balance`).set(receiverNewBalance);
                            
                            // –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
                            const senderHistoryId = Date.now().toString();
                            rtdb.ref(`history/${state.user.fbKey}/${senderHistoryId}`).set({
                                title: `–ü–µ—Ä–µ–≤–æ–¥ ${receiver.name}`,
                                val: amount,
                                type: 'minus',
                                status: 'done',
                                timestamp: Date.now(),
                                ico: 'üí∏',
                                desc: message || '–ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è'
                            });
                            
                            // –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ª—É—á–∞—Ç–µ–ª—è
                            const receiverHistoryId = (Date.now() + 1).toString();
                            rtdb.ref(`history/${receiverKey}/${receiverHistoryId}`).set({
                                title: `–ü–µ—Ä–µ–≤–æ–¥ –æ—Ç ${state.user.name}`,
                                val: amount,
                                type: 'plus',
                                status: 'done',
                                timestamp: Date.now(),
                                ico: 'üí∏',
                                desc: message || '–ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è'
                            });
                            
                            document.getElementById('modal-confirm').style.display = 'none';
                            
                            view.showSuccess(
                                '–ü–µ—Ä–µ–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω',
                                `-${amount.toLocaleString()} ‚ÇΩ`,
                                `–°—Ä–µ–¥—Å—Ç–≤–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${receiver.name}`,
                                '‚úÖ'
                            );
                            
                            // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
                            document.getElementById('tr-target').value = '';
                            document.getElementById('tr-val').value = '';
                            document.getElementById('tr-msg').value = '';
                            
                            // –û–±–Ω–æ–≤–∏—Ç—å dashboard
                            setTimeout(() => {
                                view.loadDashboard();
                                view.nav('screen-home');
                            }, 1500);
                        }
                    );
                });
            },
            
            exchange: () => {
                const amount = parseFloat(document.getElementById('ex-val').value);
                
                if(!amount || amount <= 0) {
                    alert('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–ª—è –æ–±–º–µ–Ω–∞');
                    return;
                }
                
                const rubAmount = amount * 91.20; // –ö—É—Ä—Å USD/RUB
                
                if(state.user.balance < rubAmount) {
                    alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä—É–±–ª–µ–π –¥–ª—è –æ–±–º–µ–Ω–∞');
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                view.showConfirm(
                    '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–±–º–µ–Ω',
                    `–û–±–º–µ–Ω ${amount.toFixed(2)} $ –Ω–∞ ${rubAmount.toFixed(2)} ‚ÇΩ –ø–æ –∫—É—Ä—Å—É 91.20`,
                    'üí±',
                    () => {
                        // –°–ø–∏—Å–∞—Ç—å —Ä—É–±–ª–∏
                        const newRubBalance = state.user.balance - rubAmount;
                        rtdb.ref(`users/${state.user.fbKey}/balance`).set(newRubBalance);
                        state.user.balance = newRubBalance;
                        
                        // –ó–∞—á–∏—Å–ª–∏—Ç—å –¥–æ–ª–ª–∞—Ä—ã
                        const newUsdBalance = (state.user.usd || 0) + amount;
                        rtdb.ref(`users/${state.user.fbKey}/usd`).set(newUsdBalance);
                        state.user.usd = newUsdBalance;
                        
                        // –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏
                        const historyId = Date.now().toString();
                        rtdb.ref(`history/${state.user.fbKey}/${historyId}`).set({
                            title: '–û–±–º–µ–Ω –≤–∞–ª—é—Ç—ã USD/RUB',
                            val: amount,
                            type: 'exchange',
                            status: 'done',
                            timestamp: Date.now(),
                            ico: 'üí±',
                            unit: '$',
                            desc: `–ö—É—Ä—Å: 91.20, —Å—É–º–º–∞ –≤ —Ä—É–±–ª—è—Ö: ${rubAmount.toFixed(2)} ‚ÇΩ`
                        });
                        
                        document.getElementById('modal-confirm').style.display = 'none';
                        
                        view.showSuccess(
                            '–û–±–º–µ–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω',
                            `+${amount.toFixed(2)} $`,
                            `–°–ø–∏—Å–∞–Ω–æ ${rubAmount.toFixed(2)} ‚ÇΩ –ø–æ –∫—É—Ä—Å—É 91.20`,
                            '‚úÖ'
                        );
                        
                        // –û–±–Ω–æ–≤–∏—Ç—å dashboard
                        setTimeout(() => {
                            view.loadDashboard();
                            view.nav('screen-home');
                        }, 1500);
                    }
                );
            },
            
            loan: () => {
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                if(state.user.hasCredit) {
                    alert('–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∫—Ä–µ–¥–∏—Ç–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç');
                    return;
                }
                
                const creditAmount = 50000; // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∫—Ä–µ–¥–∏—Ç–Ω—ã–π –ª–∏–º–∏—Ç
                
                view.showConfirm(
                    '–û—Ñ–æ—Ä–º–∏—Ç—å –∫—Ä–µ–¥–∏—Ç',
                    `–ö—Ä–µ–¥–∏—Ç–Ω—ã–π –ª–∏–º–∏—Ç ${creditAmount.toLocaleString()} ‚ÇΩ –Ω–∞ 12 –º–µ—Å—è—Ü–µ–≤ –ø–æ–¥ 15% –≥–æ–¥–æ–≤—ã—Ö`,
                    'üìà',
                    () => {
                        // –í—ã–¥–∞—Ç—å –∫—Ä–µ–¥–∏—Ç
                        rtdb.ref(`users/${state.user.fbKey}`).update({
                            hasCredit: true,
                            creditBalance: creditAmount
                        });
                        
                        state.user.hasCredit = true;
                        state.user.creditBalance = creditAmount;
                        
                        // –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏
                        const historyId = Date.now().toString();
                        rtdb.ref(`history/${state.user.fbKey}/${historyId}`).set({
                            title: '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–∞',
                            val: creditAmount,
                            type: 'plus',
                            status: 'done',
                            timestamp: Date.now(),
                            ico: 'üìà',
                            desc: '–ö—Ä–µ–¥–∏—Ç–Ω—ã–π –ª–∏–º–∏—Ç 50,000 ‚ÇΩ –Ω–∞ 12 –º–µ—Å—è—Ü–µ–≤'
                        });
                        
                        document.getElementById('modal-confirm').style.display = 'none';
                        
                        view.showSuccess(
                            '–ö—Ä–µ–¥–∏—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω',
                            `+${creditAmount.toLocaleString()} ‚ÇΩ`,
                            '–ö—Ä–µ–¥–∏—Ç–Ω—ã–π –ª–∏–º–∏—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è',
                            '‚úÖ'
                        );
                        
                        // –û–±–Ω–æ–≤–∏—Ç—å dashboard
                        setTimeout(() => {
                            view.loadDashboard();
                            view.nav('screen-home');
                        }, 1500);
                    }
                );
            }
        };

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
        const settings = {
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            toggleBiometric: () => {
                state.settings.biometric = !state.settings.biometric;
                document.getElementById('biometric-toggle').checked = state.settings.biometric;
                settings.saveSettings();
            },
            
            toggleNotifications: () => {
                state.settings.notifications = !state.settings.notifications;
                document.getElementById('notifications-toggle').checked = state.settings.notifications;
                settings.saveSettings();
            },
            
            toggleDarkMode: () => {
                state.settings.darkMode = !state.settings.darkMode;
                document.getElementById('dark-mode-toggle').checked = state.settings.darkMode;
                settings.saveSettings();
                
                if(!state.settings.darkMode) {
                    document.body.style.background = '#ffffff';
                    document.body.style.color = '#000000';
                } else {
                    document.body.style.background = '';
                    document.body.style.color = '';
                }
            },
            
            toggleSnow: () => {
                state.settings.snow = !state.settings.snow;
                document.getElementById('snow-toggle').checked = state.settings.snow;
                settings.saveSettings();
                
                if(state.settings.snow) {
                    initSnow();
                } else if(snowAnimationId) {
                    cancelAnimationFrame(snowAnimationId);
                    snowAnimationId = null;
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            },
            
            selectCurrency: (currency) => {
                state.settings.currency = currency;
                settings.saveSettings();
                view.loadSettings();
            },
            
            togglePushNotifications: () => {
                state.settings.pushNotifications = !state.settings.pushNotifications;
                document.getElementById('push-notifications-toggle').checked = state.settings.pushNotifications;
                settings.saveSettings();
            },
            
            toggleSound: () => {
                state.settings.sound = !state.settings.sound;
                document.getElementById('sound-toggle').checked = state.settings.sound;
                settings.saveSettings();
            },
            
            toggleVibration: () => {
                state.settings.vibration = !state.settings.vibration;
                document.getElementById('vibration-toggle').checked = state.settings.vibration;
                settings.saveSettings();
            },
            
            toggleAutoUpdate: () => {
                state.settings.autoUpdate = !state.settings.autoUpdate;
                document.getElementById('auto-update-toggle').checked = state.settings.autoUpdate;
                settings.saveSettings();
            },
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
            toggleShowBalance: () => {
                state.settings.showBalance = !state.settings.showBalance;
                document.getElementById('show-balance-toggle').checked = state.settings.showBalance;
                settings.saveSettings();
                view.loadDashboard();
            },
            
            toggleTransactionHistory: () => {
                state.settings.history = !state.settings.history;
                document.getElementById('history-toggle').checked = state.settings.history;
                settings.saveSettings();
            },
            
            toggleAnalytics: () => {
                state.settings.analytics = !state.settings.analytics;
                document.getElementById('analytics-toggle').checked = state.settings.analytics;
                settings.saveSettings();
            },
            
            toggleLocation: () => {
                state.settings.location = !state.settings.location;
                document.getElementById('location-toggle').checked = state.settings.location;
                settings.saveSettings();
            },
            
            // –°–º–µ–Ω–∞ –ü–ò–ù-–∫–æ–¥–∞
            tapCurrentPin: (digit) => {
                if(digit === 'DEL') {
                    currentPinInput = currentPinInput.slice(0, -1);
                } else if(currentPinInput.length < 4) {
                    currentPinInput += digit;
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫–∏
                for(let i = 0; i < 4; i++) {
                    const dot = document.getElementById(`current-pin-${i}`);
                    if(i < currentPinInput.length) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å–ª–∏ –ü–ò–ù –≤–≤–µ–¥–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
                if(currentPinInput.length === 4) {
                    if(currentPinInput === state.user.pin) {
                        // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–µ–∫—É—â–∏–π –ü–ò–ù
                        currentPinInput = "";
                        for(let i = 0; i < 4; i++) {
                            document.getElementById(`current-pin-${i}`).classList.remove('active');
                        }
                        view.nav('screen-new-pin');
                    } else {
                        alert('–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–µ–∫—É—â–∏–π –ü–ò–ù-–∫–æ–¥!');
                        currentPinInput = "";
                        for(let i = 0; i < 4; i++) {
                            document.getElementById(`current-pin-${i}`).classList.remove('active');
                        }
                    }
                }
            },
            
            tapNewPin: (digit) => {
                if(digit === 'DEL') {
                    newPinInput = newPinInput.slice(0, -1);
                } else if(newPinInput.length < 4) {
                    newPinInput += digit;
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫–∏
                for(let i = 0; i < 4; i++) {
                    const dot = document.getElementById(`new-pin-${i}`);
                    if(i < newPinInput.length) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å–ª–∏ –ü–ò–ù –≤–≤–µ–¥–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
                if(newPinInput.length === 4) {
                    if(newPinInput === state.user.pin) {
                        alert('–ù–æ–≤—ã–π –ü–ò–ù –Ω–µ –º–æ–∂–µ—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–µ–∫—É—â–∏–º!');
                        newPinInput = "";
                        for(let i = 0; i < 4; i++) {
                            document.getElementById(`new-pin-${i}`).classList.remove('active');
                        }
                    } else {
                        view.nav('screen-confirm-pin');
                    }
                }
            },
            
            tapConfirmPin: (digit) => {
                if(digit === 'DEL') {
                    confirmPinInput = confirmPinInput.slice(0, -1);
                } else if(confirmPinInput.length < 4) {
                    confirmPinInput += digit;
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫–∏
                for(let i = 0; i < 4; i++) {
                    const dot = document.getElementById(`confirm-pin-${i}`);
                    if(i < confirmPinInput.length) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å–ª–∏ –ü–ò–ù –≤–≤–µ–¥–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
                if(confirmPinInput.length === 4) {
                    if(confirmPinInput === newPinInput) {
                        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –ü–ò–ù
                        rtdb.ref(`users/${state.user.fbKey}/pin`).set(newPinInput);
                        state.user.pin = newPinInput;
                        
                        view.showSuccess(
                            '–ü–ò–ù-–∫–æ–¥ –∏–∑–º–µ–Ω–µ–Ω',
                            'üîê',
                            '–ù–æ–≤—ã–π –ü–ò–ù-–∫–æ–¥ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω',
                            '‚úÖ'
                        );
                        
                        // –°–±—Ä–æ—Å–∏—Ç—å –≤–≤–æ–¥—ã
                        currentPinInput = "";
                        newPinInput = "";
                        confirmPinInput = "";
                        
                        setTimeout(() => {
                            view.nav('screen-settings');
                        }, 2000);
                    } else {
                        alert('–ü–ò–ù-–∫–æ–¥—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                        newPinInput = "";
                        confirmPinInput = "";
                        for(let i = 0; i < 4; i++) {
                            document.getElementById(`new-pin-${i}`).classList.remove('active');
                            document.getElementById(`confirm-pin-${i}`).classList.remove('active');
                        }
                        view.nav('screen-new-pin');
                    }
                }
            },
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
            clearCache: () => {
                view.showConfirm(
                    '–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à?',
                    '–≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–æ –Ω–µ –∑–∞—Ç—Ä–æ–Ω–µ—Ç –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.',
                    'üßπ',
                    () => {
                        document.getElementById('modal-confirm').style.display = 'none';
                        view.showSuccess(
                            '–ö—ç—à –æ—á–∏—â–µ–Ω',
                            'üßπ',
                            '–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã',
                            '‚úÖ'
                        );
                    }
                );
            },
            
            exportData: () => {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                view.showSuccess(
                    '–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö',
                    'üì§',
                    '–ó–∞–ø—Ä–æ—Å –Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –í—ã –ø–æ–ª—É—á–∏—Ç–µ —Ñ–∞–π–ª –≤ Telegram.',
                    '‚úÖ'
                );
            },
            
            resetSettings: () => {
                view.showConfirm(
                    '–°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?',
                    '–í—Å–µ –≤–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–µ—Ä–Ω—É—Ç—Å—è –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.',
                    'üîÑ',
                    () => {
                        state.settings = {
                            biometric: false,
                            notifications: true,
                            darkMode: true,
                            currency: 'RUB',
                            snow: true,
                            showBalance: true,
                            history: true,
                            analytics: false,
                            pushNotifications: false,
                            sound: false,
                            vibration: false,
                            autoUpdate: false,
                            location: false
                        };
                        
                        localStorage.removeItem('kbank_settings');
                        view.loadSettings();
                        
                        document.getElementById('modal-confirm').style.display = 'none';
                        
                        view.showSuccess(
                            '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã',
                            'üîÑ',
                            '–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é',
                            '‚úÖ'
                        );
                    }
                );
            },
            
            deleteAccount: () => {
                view.showConfirm(
                    '–£–î–ê–õ–ò–¢–¨ –ê–ö–ö–ê–£–ù–¢?',
                    '–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å. –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ.',
                    'üóëÔ∏è',
                    () => {
                        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–æ –±—ã —É–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
                        document.getElementById('modal-confirm').style.display = 'none';
                        
                        view.showSuccess(
                            '–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω',
                            'üì®',
                            '–ó–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É. –í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram.',
                            '‚úÖ'
                        );
                    }
                );
            },
            
            sendSupportMessage: () => {
                const message = document.getElementById('support-message').value.trim();
                
                if(!message || message.length < 10) {
                    alert('–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É –ø–æ–¥—Ä–æ–±–Ω–µ–µ (–º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤)');
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–µ
                const requestId = Date.now().toString();
                rtdb.ref(`support/${requestId}`).set({
                    userId: state.user.fbKey,
                    userName: state.user.name,
                    userTgId: state.user.telegramId,
                    message: message,
                    timestamp: Date.now(),
                    status: 'new'
                });
                
                // –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ
                document.getElementById('support-message').value = '';
                
                view.showSuccess(
                    '–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ',
                    'üì®',
                    '–í–∞—à –∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ–¥–∞–Ω –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É. –û—Ç–≤–µ—Ç–∏–º –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.',
                    '‚úÖ'
                );
            },
            
            checkUpdates: () => {
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                if (MAINTENANCE_MODE === true) {
                    checkMaintenanceMode();
                    return;
                }
                
                updates.checkForUpdates();
            },
            
            saveSettings: () => {
                localStorage.setItem('kbank_settings', JSON.stringify(state.settings));
            }
        };

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const updates = {
            checkForUpdates: () => {
                const btn = document.getElementById('check-updates-btn');
                const originalText = btn.innerText;
                btn.innerText = '–ü—Ä–æ–≤–µ—Ä—è–µ–º...';
                btn.disabled = true;
                
                // –°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                setTimeout(() => {
                    const hasUpdates = Math.random() > 0.5; // 50% —à–∞–Ω—Å –Ω–∞–ª–∏—á–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                    
                    if(hasUpdates) {
                        document.getElementById('update-badge').style.display = 'block';
                        document.getElementById('updates-status').innerText = '–î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ';
                        
                        view.showSuccess(
                            '–î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ',
                            'üîÑ',
                            '–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏',
                            '‚úÖ'
                        );
                    } else {
                        document.getElementById('updates-status').innerText = '–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è';
                        
                        view.showSuccess(
                            '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã',
                            '‚úÖ',
                            '–£ –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è',
                            '‚úÖ'
                        );
                    }
                    
                    btn.innerText = originalText;
                    btn.disabled = false;
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
                    const now = new Date();
                    document.getElementById('last-checked').innerText = 
                        `–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ${now.toLocaleDateString('ru-RU')} ${now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'})}`;
                    document.getElementById('last-check-time').innerText = 
                        `${now.toLocaleDateString('ru-RU')} ${now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'})}`;
                        
                }, 1500);
            },
            
            loadUpdatesScreen: () => {
                document.getElementById('current-version').innerText = `–í–µ—Ä—Å–∏—è ${state.appVersion}`;
                document.getElementById('app-version').innerText = `–í–µ—Ä—Å–∏—è ${state.appVersion}`;
                document.getElementById('app-build').innerText = `Build ${state.appBuild}`;
                
                const updatesList = document.getElementById('updates-list');
                updatesList.innerHTML = '';
                
                // –ü—Ä–∏–º–µ—Ä —Å–ø–∏—Å–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                const sampleUpdates = [
                    {
                        date: '15.12.2024',
                        description: '–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ QR-–ø–ª–∞—Ç–µ–∂–µ–π, —É–ª—É—á—à–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å'
                    },
                    {
                        date: '01.12.2024',
                        description: '–ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π'
                    },
                    {
                        date: '15.11.2024',
                        description: '–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏, —É–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å'
                    }
                ];
                
                sampleUpdates.forEach(update => {
                    const updateHTML = `
                        <div class="update-item glass-effect" style="padding: 16px; margin-bottom: 12px;">
                            <div class="update-date">${update.date}</div>
                            <div class="update-description">${update.description}</div>
                        </div>
                    `;
                    updatesList.innerHTML += updateHTML;
                });
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                document.getElementById('auto-update-status').innerText = 
                    state.settings.autoUpdate ? '–í–∫–ª—é—á–µ–Ω–æ' : '–í—ã–∫–ª—é—á–µ–Ω–æ';
            },
            
            loadAllUpdates: () => {
                const allUpdatesList = document.getElementById('all-updates-list');
                allUpdatesList.innerHTML = '';
                
                // –ë–æ–ª–µ–µ –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                const allUpdates = [
                    { version: '2.0.1', date: '15.12.2024', description: '–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ QR-–ø–ª–∞—Ç–µ–∂–µ–π' },
                    { version: '2.0.0', date: '01.12.2024', description: '–ü–æ–ª–Ω—ã–π —Ä–µ–¥–∏–∑–∞–π–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞' },
                    { version: '1.5.0', date: '15.11.2024', description: '–î–æ–±–∞–≤–ª–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π' },
                    { version: '1.4.0', date: '01.11.2024', description: '–î–æ–±–∞–≤–ª–µ–Ω –æ–±–º–µ–Ω –≤–∞–ª—é—Ç' },
                    { version: '1.3.0', date: '15.10.2024', description: '–î–æ–±–∞–≤–ª–µ–Ω—ã –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã' },
                    { version: '1.2.0', date: '01.10.2024', description: '–£–ª—É—á—à–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å' },
                    { version: '1.1.0', date: '15.09.2024', description: '–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏' },
                    { version: '1.0.0', date: '01.09.2024', description: '–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–ª–∏–∑' }
                ];
                
                allUpdates.forEach(update => {
                    const updateHTML = `
                        <div class="glass-effect" style="padding: 20px; margin-bottom: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                <div style="font-size: 17px; font-weight: 600;">–í–µ—Ä—Å–∏—è ${update.version}</div>
                                <div style="font-size: 14px; color: var(--text-dim);">${update.date}</div>
                            </div>
                            <div style="font-size: 15px; color: var(--text-dim); margin-top: 8px;">${update.description}</div>
                        </div>
                    `;
                    allUpdatesList.innerHTML += updateHTML;
                });
            },
            
            viewAllUpdates: () => {
                view.nav('screen-all-updates');
            }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
            checkMaintenanceMode();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–µ–∂–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é
            initSnow();
            
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é
            const savedSession = localStorage.getItem('kbank_session');
            if(savedSession) {
                const session = JSON.parse(savedSession);
                
                // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Å—Å–∏–∏ (24 —á–∞—Å–∞)
                const sessionAge = Date.now() - session.timestamp;
                if(sessionAge < 24 * 60 * 60 * 1000) {
                    // –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    rtdb.ref(`users/${session.userId}`).once('value').then(snapshot => {
                        const userData = snapshot.val();
                        if(userData) {
                            state.user = { ...userData, fbKey: session.userId };
                            view.nav('screen-pin-entry');
                        }
                    });
                } else {
                    localStorage.removeItem('kbank_session');
                }
            }
            
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            const savedSettings = localStorage.getItem('kbank_settings');
            if(savedSettings) {
                state.settings = JSON.parse(savedSettings);
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            if(state.settings.snow) {
                initSnow();
            }
            
            // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏
            document.getElementById('current-version').innerText = `–í–µ—Ä—Å–∏—è ${state.appVersion}`;
            document.getElementById('app-version').innerText = `–í–µ—Ä—Å–∏—è ${state.appVersion}`;
            document.getElementById('app-build').innerText = `Build ${state.appBuild}`;
        };

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
        document.addEventListener('touchstart', function(e) {
            if(e.touches.length > 1) e.preventDefault();
        }, { passive: false });

        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = Date.now();
            if(now - lastTouchEnd <= 300) e.preventDefault();
            lastTouchEnd = now;
        }, { passive: false });
    </script>
</body>
</html>
